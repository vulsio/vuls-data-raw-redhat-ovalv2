{
  "id": "oval:com.redhat.cve:def:201810871",
  "version": "636",
  "class": "vulnerability",
  "metadata": {
    "title": "CVE-2018-10871 389-ds-base: replication and the Retro Changelog plugin store plaintext password by default (moderate)",
    "reference": [
      {
        "ref_id": "CVE-2018-10871",
        "ref_url": "https://access.redhat.com/security/cve/CVE-2018-10871",
        "source": "CVE"
      }
    ],
    "description": "DOCUMENTATION: By default, when the Replica and/or retroChangeLog plugins are enabled, 389-ds-base stores passwords in plaintext format in their respective changelog files. An attacker with sufficiently high privileges, such as root or Directory Manager, can query these files in order to retrieve plaintext passwords.\n            \n            MITIGATION: On 389-ds-base 1.3.1 and above: \n1- Deactivate clear password storing by default, to prevent new passwords to be logged.\n-> in cn=config, set nsslapd-unhashed-pw-switch attribute to 'off' or 'nolog'\n\n2- Trim changelog to ensure currently stored passwords are removed.\nFor Replication:\n-> in cn=changelog5,cn=config, reduce nsslapd-changelogmaxentries, nsslapd-changelogtrim-interval and nsslapd-changelogmaxage\n-> force a replication & wait for the changelogtrim-interval time\n-> restore previous values\n\nFor RetroChangelog:\n-> deactivate the plugin\n-> restart directory server\n-> reactivate the plugin\n-> restart directory server",
    "advisory": {
      "from": "secalert@redhat.com",
      "severity": "Moderate",
      "updated": {
        "date": "2021-02-17"
      },
      "cve": [
        {
          "text": "CVE-2018-10871",
          "cvss3": "3.8/CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:N",
          "cwe": "CWE-312",
          "href": "https://access.redhat.com/security/cve/CVE-2018-10871",
          "impact": "moderate",
          "public": "20180618"
        }
      ],
      "affected": {
        "resolution": [
          {
            "state": "Will not fix",
            "component": [
              "389-ds-base",
              "389-ds-base-devel",
              "389-ds-base-libs"
            ]
          }
        ]
      },
      "affected_cpe_list": {
        "cpe": [
          "cpe:/a:redhat:rhel_extras:6",
          "cpe:/a:redhat:rhel_extras_hpn:6",
          "cpe:/a:redhat:rhel_extras_oracle_java:6",
          "cpe:/a:redhat:rhel_extras_sap:6",
          "cpe:/a:redhat:rhel_extras_sap_hana:6",
          "cpe:/o:redhat:enterprise_linux:6",
          "cpe:/o:redhat:enterprise_linux:6::client",
          "cpe:/o:redhat:enterprise_linux:6::computenode",
          "cpe:/o:redhat:enterprise_linux:6::server",
          "cpe:/o:redhat:enterprise_linux:6::workstation",
          "cpe:/o:redhat:rhel_eus:6.0"
        ]
      },
      "issued": {}
    },
    "affected": {}
  },
  "criteria": {
    "operator": "OR",
    "criterias": [
      {
        "operator": "AND",
        "criterias": [
          {
            "operator": "OR",
            "criterias": [
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20177551001",
                    "comment": "389-ds-base is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20177551002",
                    "comment": "389-ds-base is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20177551003",
                    "comment": "389-ds-base-devel is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20177551004",
                    "comment": "389-ds-base-devel is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20177551005",
                    "comment": "389-ds-base-libs is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20177551006",
                    "comment": "389-ds-base-libs is signed with Red Hat redhatrelease2 key"
                  }
                ]
              }
            ]
          }
        ],
        "criterions": [
          {
            "test_ref": "oval:com.redhat.cve:tst:20022439069",
            "comment": "Red Hat Enterprise Linux 6 is installed"
          }
        ]
      }
    ],
    "criterions": [
      {
        "test_ref": "oval:com.redhat.cve:tst:20022439070",
        "comment": "Red Hat Enterprise Linux must be installed"
      }
    ]
  }
}
