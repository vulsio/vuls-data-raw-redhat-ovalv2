{
	"id": "oval:com.redhat.rhsa:def:20151344",
	"version": "646",
	"class": "patch",
	"metadata": {
		"title": "RHSA-2015:1344: autofs security and bug fix update (Moderate)",
		"reference": [
			{
				"ref_id": "RHSA-2015:1344",
				"ref_url": "https://access.redhat.com/errata/RHSA-2015:1344",
				"source": "RHSA"
			},
			{
				"ref_id": "CVE-2014-8169",
				"ref_url": "https://access.redhat.com/security/cve/CVE-2014-8169",
				"source": "CVE"
			}
		],
		"description": "The autofs utility controls the operation of the automount daemon. The \ndaemon automatically mounts file systems when in use and unmounts them when \nthey are not busy.\n\nIt was found that program-based automounter maps that used interpreted\nlanguages such as Python would use standard environment variables to locate\nand load modules of those languages. A local attacker could potentially use\nthis flaw to escalate their privileges on the system. (CVE-2014-8169)\n\nNote: This issue has been fixed by adding the \"AUTOFS_\" prefix to the\naffected environment variables so that they are not used to subvert the\nsystem. A configuration option (\"force_standard_program_map_env\") to\noverride this prefix and to use the environment variables without the\nprefix has been added. In addition, warnings have been added to the manual\npage and to the installed configuration file. Now, by default the standard\nvariables of the program map are provided only with the prefix added to\nits name.\n\nRed Hat would like to thank the Georgia Institute of Technology for\nreporting this issue.\n\nBug fixes:\n\n* If the \"ls *\" command was executed before a valid mount, the autofs\nprogram failed on further mount attempts inside the mount point, whether\nthe mount point was valid or not. While attempting to mount, the \"ls *\"\ncommand of the root directory of an indirect mount was executed, which\nled to an attempt to mount \"*\", causing it to be added to the negative\nmap entry cache. This bug has been fixed by checking for and not adding\n\"*\" while updating the negative map entry cache. (BZ#1163957)\n\n* The autofs program by design did not mount host map entries that were\nduplicate exports in an NFS server export list. The duplicate entries in a\nmulti-mount map entry were recognized as a syntax error and autofs refused\nto perform mounts when the duplicate entries occurred. Now, autofs has been\nchanged to continue mounting the last seen instance of the duplicate entry\nrather than fail, and to report the problem in the log files to alert the\nsystem administrator. (BZ#1124083)\n\n* The autofs program did not recognize the yp map type in the master map.\nThis was caused by another change in the master map parser to fix a problem\nwith detecting the map format associated with mapping the type in the\nmaster map. The change led to an incorrect length for the type comparison\nof yp maps that resulted in a match operation failure. This bug has been\nfixed by correcting the length which is used for the comparison.\n(BZ#1153130)\n\n* The autofs program did not update the export list of the Sun-format maps\nof the network shares exported from an NFS server. This happened due to a\nchange of the Sun-format map parser leading to the hosts map update to stop\nworking on the map re-read operation. The bug has been now fixed by\nselectively preventing this type of update only for the Sun-formatted maps.\nThe updates of the export list on the Sun-format maps are now visible and\nrefreshing of the export list is no longer supported for the Sun-formatted\nhosts map. (BZ#1156387)\n\n* Within changes made for adding of the Sun-format maps, an incorrect check \nwas added that caused a segmentation fault in the Sun-format map parser in \ncertain circumstances. This has been now fixed by analyzing the intent of \nthe incorrect check and changing it in order to properly identify the \nconditions without causing a fault. (BZ#1175671)\n\n* A bug in the autofs program map lookup module caused an incorrect map\nformat type comparison. The incorrect comparison affected the Sun-format\nprogram maps where it led to the unused macro definitions. The bug in the\ncomparison has been fixed so that the macro definitions are not present for\nthe Sun-format program maps. (BZ#1201195)\n\nUsers of autofs are advised to upgrade to these updated packages, which\ncontain backported patches to correct these issues.",
		"advisory": {
			"from": "secalert@redhat.com",
			"severity": "Moderate",
			"updated": {
				"date": "2015-07-22"
			},
			"cve": [
				{
					"text": "CVE-2014-8169",
					"cwe": "CWE-20->CWE-426",
					"href": "https://access.redhat.com/security/cve/CVE-2014-8169",
					"impact": "moderate",
					"public": "20150302",
					"cvss2": "4.6/AV:L/AC:L/Au:N/C:P/I:P/A:P"
				}
			],
			"affected": {},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:redhat:rhel_aus:6.5",
					"cpe:/o:redhat:rhel_aus:6.5::server"
				]
			},
			"rights": "Copyright 2015 Red Hat, Inc.",
			"issued": {
				"date": "2015-07-20"
			},
			"bugzilla": [
				{
					"text": "priv escalation via interpreter load path for program based automount maps",
					"href": "https://bugzilla.redhat.com/1192565",
					"id": "1192565"
				}
			]
		},
		"affected": {
			"family": "unix",
			"platform": [
				"Red Hat Enterprise Linux 6"
			]
		}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterions": [
					{
						"test_ref": "oval:com.redhat.rhba:tst:20111656003",
						"comment": "Red Hat Enterprise Linux 6 is installed"
					},
					{
						"test_ref": "oval:com.redhat.rhsa:tst:20151344001",
						"comment": "autofs is earlier than 1:5.0.5-113.el6"
					},
					{
						"test_ref": "oval:com.redhat.rhsa:tst:20151344002",
						"comment": "autofs is signed with Red Hat redhatrelease2 key"
					}
				]
			}
		],
		"criterions": [
			{
				"test_ref": "oval:com.redhat.rhba:tst:20111656004",
				"comment": "Red Hat Enterprise Linux must be installed"
			}
		]
	}
}
