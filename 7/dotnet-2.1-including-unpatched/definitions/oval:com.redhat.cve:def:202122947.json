{
  "id": "oval:com.redhat.cve:def:202122947",
  "version": "636",
  "class": "vulnerability",
  "metadata": {
    "title": "CVE-2021-22947 curl: Server responses received before STARTTLS processed after TLS handshake (moderate)",
    "reference": [
      {
        "ref_id": "CVE-2021-22947",
        "ref_url": "https://access.redhat.com/security/cve/CVE-2021-22947",
        "source": "CVE"
      }
    ],
    "description": "DOCUMENTATION: A flaw was found in curl. The flaw lies in how curl handles cached or pipelined responses that it receives from either a IMAP, POP3, SMTP or FTP server before the TLS upgrade using STARTTLS. In such a scenario curl even after upgrading to TLS would trust these cached responses treating them as valid and authenticated and use them. An attacker could potentially use this flaw to carry out a Man-In-The-Middle attack. The highest threat from this vulnerability is to data confidentiality.",
    "advisory": {
      "from": "secalert@redhat.com",
      "severity": "Moderate",
      "updated": {
        "date": "2022-05-10"
      },
      "cve": [
        {
          "text": "CVE-2021-22947",
          "cvss3": "6.1/CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:N/A:N",
          "cwe": "CWE-319",
          "href": "https://access.redhat.com/security/cve/CVE-2021-22947",
          "impact": "moderate",
          "public": "20210915"
        }
      ],
      "affected": {
        "resolution": [
          {
            "state": "Out of support scope",
            "component": [
              "rh-dotnet21-curl",
              "rh-dotnet21-libcurl",
              "rh-dotnet21-libcurl-devel"
            ]
          }
        ]
      },
      "affected_cpe_list": {
        "cpe": [
          "cpe:/a:redhat:rhel_dotnet:2.1",
          "cpe:/a:redhat:rhel_dotnet:2.1::el7"
        ]
      },
      "issued": {}
    },
    "affected": {}
  },
  "criteria": {
    "operator": "OR",
    "criterias": [
      {
        "operator": "AND",
        "criterias": [
          {
            "operator": "OR",
            "criterias": [
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20165419003",
                    "comment": "rh-dotnet21-curl is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20165419004",
                    "comment": "rh-dotnet21-curl is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20165419005",
                    "comment": "rh-dotnet21-libcurl is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20165419006",
                    "comment": "rh-dotnet21-libcurl is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20165419001",
                    "comment": "rh-dotnet21-libcurl-devel is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20165419002",
                    "comment": "rh-dotnet21-libcurl-devel is signed with Red Hat redhatrelease2 key"
                  }
                ]
              }
            ]
          }
        ],
        "criterions": [
          {
            "test_ref": "oval:com.redhat.cve:tst:20165419007",
            "comment": "Red Hat Enterprise Linux 7 is installed"
          }
        ]
      }
    ],
    "criterions": [
      {
        "test_ref": "oval:com.redhat.cve:tst:20165419008",
        "comment": "Red Hat Enterprise Linux must be installed"
      }
    ]
  }
}
