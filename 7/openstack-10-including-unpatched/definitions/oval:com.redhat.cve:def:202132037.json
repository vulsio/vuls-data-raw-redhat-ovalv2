{
  "id": "oval:com.redhat.cve:def:202132037",
  "version": "636",
  "class": "vulnerability",
  "metadata": {
    "title": "Using $sample can trigger invariant when connecting directly to shards (moderate)",
    "reference": [
      {
        "ref_id": "CVE-2021-32037",
        "ref_url": "https://access.redhat.com/security/cve/CVE-2021-32037",
        "source": "CVE"
      }
    ],
    "description": "DOCUMENTATION: An assertion flaw was found in the mongodb server where an aggregation request could trigger an invariant.  An authorized user could exploit this flaw by sending a relevant aggregation request to a shard, which could result in a denial of service or server exit. Requests are usually sent via mongos and special privileges are required in order to know the address of the shards and to log in to the shards of an auth-enabled environment. \n            \n            MITIGATION: Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
    "advisory": {
      "from": "secalert@redhat.com",
      "severity": "Moderate",
      "updated": {
        "date": "2023-07-07"
      },
      "cve": [
        {
          "text": "CVE-2021-32037",
          "cvss3": "6.5/CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
          "cwe": "CWE-617",
          "href": "https://access.redhat.com/security/cve/CVE-2021-32037",
          "impact": "moderate",
          "public": "20211124"
        }
      ],
      "affected": {
        "resolution": [
          {
            "state": "Out of support scope",
            "component": [
              "mongodb",
              "mongodb-server"
            ]
          }
        ]
      },
      "affected_cpe_list": {
        "cpe": [
          "cpe:/a:redhat:openstack-optools:10",
          "cpe:/a:redhat:openstack-optools:10::el7",
          "cpe:/a:redhat:openstack:10",
          "cpe:/a:redhat:openstack:10::el7"
        ]
      },
      "issued": {}
    },
    "affected": {}
  },
  "criteria": {
    "operator": "OR",
    "criterias": [
      {
        "operator": "AND",
        "criterias": [
          {
            "operator": "OR",
            "criterias": [
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:201820802003",
                    "comment": "mongodb is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:201820802004",
                    "comment": "mongodb is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:201820802001",
                    "comment": "mongodb-server is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:201820802002",
                    "comment": "mongodb-server is signed with Red Hat redhatrelease2 key"
                  }
                ]
              }
            ]
          }
        ],
        "criterions": [
          {
            "test_ref": "oval:com.redhat.cve:tst:20115034003",
            "comment": "Red Hat Enterprise Linux 7 is installed"
          }
        ]
      }
    ],
    "criterions": [
      {
        "test_ref": "oval:com.redhat.cve:tst:20115034004",
        "comment": "Red Hat Enterprise Linux must be installed"
      }
    ]
  }
}
