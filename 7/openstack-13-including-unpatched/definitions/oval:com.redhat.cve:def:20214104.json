{
  "id": "oval:com.redhat.cve:def:20214104",
  "version": "636",
  "class": "vulnerability",
  "metadata": {
    "title": "Remote code execution in Log4j 1.x when application is configured to use JMSAppender (moderate)",
    "reference": [
      {
        "ref_id": "CVE-2021-4104",
        "ref_url": "https://access.redhat.com/security/cve/CVE-2021-4104",
        "source": "CVE"
      }
    ],
    "description": "DOCUMENTATION: A flaw was found in the Java logging library Apache Log4j in version 1.x. JMSAppender in Log4j 1.x is vulnerable to deserialization of untrusted data. This allows a remote attacker to execute code on the server if the deployed application is configured to use JMSAppender and to the attacker's JNDI LDAP endpoint. \n            STATEMENT: Based on the conditions to be exploitable (see details below), the risk is much lower than Log4j 2.x and Red Hat has assessed this to be Moderate severity. This flaw has been filed for Log4j 1.x, and the corresponding flaw information for Log4j 2.x is available at: https://access.redhat.com/security/cve/CVE-2021-44228\n\nNote this flaw ONLY affects applications which are specifically configured to use JMSAppender, which is not the default, or when the attacker has write access to the Log4j configuration for adding JMSAppender to the attacker's JNDI LDAP endpoint. \n\nIf the Log4j configuration is set TopicBindingName or TopicConnectionFactoryBindingName configurations allowing JMSAppender to perform JNDI requests that result in remote code execution in a similar fashion to CVE-2021-44228 Log4j 2.x, Log4j 1.x is vulnerable. However, the attack vector is reduced as it depends on having write access, which is not a standard configuration rather than untrusted user input. These are sufficient factors beyond the attacker's control.\n\nThe tomcat package shipped with Red Hat Enterprise Linux does not include log4j but it does include a default configuration for log4j, log4j.properties, which could be used with tomcat if users choose to install and configure the library. The JMSAppender is not enabled by default, and the permissions of the file can only be modified as root.\n\nRed Hat Virtualization ships log4j12-1.2.17, but it is used and configured in a way which makes this flaw not possible to exploit. Therefore impact is rated Low.\n            MITIGATION: These are the possible mitigations for this flaw for releases version 1.x:\n\n- Comment out or remove JMSAppender in the Log4j configuration if it is used\n- Remove the JMSAppender class from the classpath. For example:\n```\nzip -q -d log4j-*.jar org/apache/log4j/net/JMSAppender.class\n```\n- Restrict access for the OS user on the platform running the application to prevent modifying the Log4j configuration by the attacker.",
    "advisory": {
      "from": "secalert@redhat.com",
      "severity": "Moderate",
      "updated": {
        "date": "2023-09-15"
      },
      "cve": [
        {
          "text": "CVE-2021-4104",
          "cvss3": "7.5/CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "cwe": "CWE-20",
          "href": "https://access.redhat.com/security/cve/CVE-2021-4104",
          "impact": "moderate",
          "public": "20211210"
        }
      ],
      "affected": {
        "resolution": [
          {
            "state": "Out of support scope",
            "component": [
              "opendaylight"
            ]
          }
        ]
      },
      "affected_cpe_list": {
        "cpe": [
          "cpe:/a:redhat:openstack-optools:13",
          "cpe:/a:redhat:openstack-optools:13::el7",
          "cpe:/a:redhat:openstack:13",
          "cpe:/a:redhat:openstack:13::el7"
        ]
      },
      "issued": {}
    },
    "affected": {}
  },
  "criteria": {
    "operator": "OR",
    "criterias": [
      {
        "operator": "AND",
        "criterions": [
          {
            "test_ref": "oval:com.redhat.cve:tst:20115034003",
            "comment": "Red Hat Enterprise Linux 7 is installed"
          },
          {
            "test_ref": "oval:com.redhat.cve:tst:20115034001",
            "comment": "opendaylight is installed"
          },
          {
            "test_ref": "oval:com.redhat.cve:tst:20115034002",
            "comment": "opendaylight is signed with Red Hat redhatrelease2 key"
          }
        ]
      }
    ],
    "criterions": [
      {
        "test_ref": "oval:com.redhat.cve:tst:20115034004",
        "comment": "Red Hat Enterprise Linux must be installed"
      }
    ]
  }
}
