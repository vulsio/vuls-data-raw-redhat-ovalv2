{
  "id": "oval:com.redhat.cve:def:20220358",
  "version": "636",
  "class": "vulnerability",
  "metadata": {
    "title": "CVE-2022-0358 QEMU: virtiofsd: potential privilege escalation via CVE-2018-13405 (moderate)",
    "reference": [
      {
        "ref_id": "CVE-2022-0358",
        "ref_url": "https://access.redhat.com/security/cve/CVE-2022-0358",
        "source": "CVE"
      }
    ],
    "description": "DOCUMENTATION: A flaw was found in the QEMU virtio-fs shared file system daemon (virtiofsd) implementation. This flaw is strictly related to CVE-2018-13405. A local guest user can create files in the directories shared by virtio-fs with unintended group ownership in a scenario where a directory is SGID to a certain group and is writable by a user who is not a member of the group. This could allow a malicious unprivileged user inside the guest to gain access to resources accessible to the root group, potentially escalating their privileges within the guest. A malicious local user in the host might also leverage this unexpected executable file created by the guest to escalate their privileges on the host system. \n            STATEMENT: This issue does not affect the versions of the `qemu-kvm` package as shipped with Red Hat Enterprise Linux 6 and 7. Virtio-fs is a fairly new feature (introduced upstream in QEMU v5.0) which is not built in Red Hat Enterprise Linux 6 and 7.\n            MITIGATION: Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
    "advisory": {
      "from": "secalert@redhat.com",
      "severity": "Moderate",
      "updated": {
        "date": "2022-08-09"
      },
      "cve": [
        {
          "text": "CVE-2022-0358",
          "cvss3": "7.0/CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "cwe": "CWE-273",
          "href": "https://access.redhat.com/security/cve/CVE-2022-0358",
          "impact": "moderate",
          "public": "20220125"
        }
      ],
      "affected": {
        "resolution": [
          {
            "state": "Out of support scope",
            "component": [
              "qemu-img-rhev",
              "qemu-kvm-common-rhev",
              "qemu-kvm-rhev",
              "qemu-kvm-tools-rhev"
            ]
          }
        ]
      },
      "affected_cpe_list": {
        "cpe": [
          "cpe:/a:redhat:openstack-optools:13",
          "cpe:/a:redhat:openstack-optools:13::el7",
          "cpe:/a:redhat:openstack:13",
          "cpe:/a:redhat:openstack:13::el7"
        ]
      },
      "issued": {}
    },
    "affected": {}
  },
  "criteria": {
    "operator": "OR",
    "criterias": [
      {
        "operator": "AND",
        "criterias": [
          {
            "operator": "OR",
            "criterias": [
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:201810839005",
                    "comment": "qemu-img-rhev is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:201810839006",
                    "comment": "qemu-img-rhev is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:201810839001",
                    "comment": "qemu-kvm-rhev is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:201810839002",
                    "comment": "qemu-kvm-rhev is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:201810839003",
                    "comment": "qemu-kvm-common-rhev is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:201810839004",
                    "comment": "qemu-kvm-common-rhev is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:201810839007",
                    "comment": "qemu-kvm-tools-rhev is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:201810839008",
                    "comment": "qemu-kvm-tools-rhev is signed with Red Hat redhatrelease2 key"
                  }
                ]
              }
            ]
          }
        ],
        "criterions": [
          {
            "test_ref": "oval:com.redhat.cve:tst:20115034003",
            "comment": "Red Hat Enterprise Linux 7 is installed"
          }
        ]
      }
    ],
    "criterions": [
      {
        "test_ref": "oval:com.redhat.cve:tst:20115034004",
        "comment": "Red Hat Enterprise Linux must be installed"
      }
    ]
  }
}
