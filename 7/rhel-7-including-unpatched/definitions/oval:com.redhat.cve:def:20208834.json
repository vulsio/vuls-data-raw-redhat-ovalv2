{
  "id": "oval:com.redhat.cve:def:20208834",
  "version": "636",
  "class": "vulnerability",
  "metadata": {
    "title": "CVE-2020-8834 Kernel: ppc: kvm: conflicting use of HSTATE_HOST_R1 to store r1 state leads to host stack corruption (important)",
    "reference": [
      {
        "ref_id": "CVE-2020-8834",
        "ref_url": "https://access.redhat.com/security/cve/CVE-2020-8834",
        "source": "CVE"
      }
    ],
    "description": "DOCUMENTATION: A flaw was found in the way the KVM hypervisor on the Power8 processor stores the r1 register state in the 'HSTATE_HOST_R1' field on the Linux kernel stack. This flaw occurs while handling hypercalls in Transactional Memory (TM) suspend mode in the kvmppc_save_tm and kvmppc_restore_tm routines, leading to host stack corruption. R1 register holds a stack frame address and its corruption leads the kernel into panic state. A guest user can use this flaw to crash the host kernel, resulting in a denial of service. \n            STATEMENT: This issue does not affect the versions of the Linux kernel as shipped with the Red Hat Enterprise Linux 5, 6, 8 and Red Hat Enterprise MRG 2.\nThis issue affects the versions of the kernel package as shipped with the Red Hat Enterprise Linux 7. Future kernel updates for the Red Hat Enterprise Linux 7 may address this issue.",
    "advisory": {
      "from": "secalert@redhat.com",
      "severity": "Important",
      "updated": {
        "date": "2021-06-29"
      },
      "cve": [
        {
          "text": "CVE-2020-8834",
          "cvss3": "6.0/CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:C/C:N/I:N/A:H",
          "cwe": "CWE-121",
          "href": "https://access.redhat.com/security/cve/CVE-2020-8834",
          "impact": "important",
          "public": "20200406:1600"
        }
      ],
      "affected": {
        "resolution": [
          {
            "state": "Affected",
            "component": [
              "bpftool",
              "kernel",
              "kernel-abi-whitelists",
              "kernel-bootwrapper",
              "kernel-debug",
              "kernel-debug-devel",
              "kernel-devel",
              "kernel-doc",
              "kernel-headers",
              "kernel-kdump",
              "kernel-kdump-devel",
              "kernel-tools",
              "kernel-tools-libs",
              "kernel-tools-libs-devel",
              "perf",
              "python-perf"
            ]
          }
        ]
      },
      "affected_cpe_list": {
        "cpe": [
          "cpe:/a:redhat:rhel_extras:7",
          "cpe:/a:redhat:rhel_extras_oracle_java:7",
          "cpe:/a:redhat:rhel_extras_rt:7",
          "cpe:/a:redhat:rhel_extras_sap:7",
          "cpe:/a:redhat:rhel_extras_sap_hana:7",
          "cpe:/o:redhat:enterprise_linux:7",
          "cpe:/o:redhat:enterprise_linux:7::client",
          "cpe:/o:redhat:enterprise_linux:7::computenode",
          "cpe:/o:redhat:enterprise_linux:7::container",
          "cpe:/o:redhat:enterprise_linux:7::containers",
          "cpe:/o:redhat:enterprise_linux:7::server",
          "cpe:/o:redhat:enterprise_linux:7::workstation"
        ]
      },
      "issued": {}
    },
    "affected": {}
  },
  "criteria": {
    "operator": "OR",
    "criterias": [
      {
        "operator": "AND",
        "criterias": [
          {
            "operator": "OR",
            "criterias": [
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542013",
                    "comment": "kernel-bootwrapper is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542014",
                    "comment": "kernel-bootwrapper is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542017",
                    "comment": "kernel-tools-libs-devel is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542018",
                    "comment": "kernel-tools-libs-devel is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542025",
                    "comment": "kernel is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542026",
                    "comment": "kernel is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542029",
                    "comment": "kernel-tools-libs is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542030",
                    "comment": "kernel-tools-libs is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542031",
                    "comment": "kernel-headers is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542032",
                    "comment": "kernel-headers is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542003",
                    "comment": "kernel-debug is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542004",
                    "comment": "kernel-debug is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542023",
                    "comment": "kernel-abi-whitelists is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542024",
                    "comment": "kernel-abi-whitelists is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542001",
                    "comment": "kernel-debug-devel is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542002",
                    "comment": "kernel-debug-devel is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542007",
                    "comment": "kernel-kdump is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542008",
                    "comment": "kernel-kdump is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542011",
                    "comment": "perf is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542012",
                    "comment": "perf is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542021",
                    "comment": "python-perf is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542022",
                    "comment": "python-perf is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542005",
                    "comment": "kernel-doc is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542006",
                    "comment": "kernel-doc is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542009",
                    "comment": "bpftool is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542010",
                    "comment": "bpftool is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542019",
                    "comment": "kernel-kdump-devel is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542020",
                    "comment": "kernel-kdump-devel is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542027",
                    "comment": "kernel-tools is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542028",
                    "comment": "kernel-tools is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542015",
                    "comment": "kernel-devel is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542016",
                    "comment": "kernel-devel is signed with Red Hat redhatrelease2 key"
                  }
                ]
              }
            ]
          }
        ],
        "criterions": [
          {
            "test_ref": "oval:com.redhat.cve:tst:20042779005",
            "comment": "Red Hat Enterprise Linux 7 is installed"
          }
        ]
      }
    ],
    "criterions": [
      {
        "test_ref": "oval:com.redhat.cve:tst:20042779006",
        "comment": "Red Hat Enterprise Linux must be installed"
      }
    ]
  }
}
