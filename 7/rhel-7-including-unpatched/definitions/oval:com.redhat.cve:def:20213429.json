{
  "id": "oval:com.redhat.cve:def:20213429",
  "version": "636",
  "class": "vulnerability",
  "metadata": {
    "title": "CVE-2021-3429 cloud-init: randomly generated passwords logged in clear-text to world-readable file (moderate)",
    "reference": [
      {
        "ref_id": "CVE-2021-3429",
        "ref_url": "https://access.redhat.com/security/cve/CVE-2021-3429",
        "source": "CVE"
      }
    ],
    "description": "DOCUMENTATION: A flaw was found in cloud-init. When a system is configured through cloud-init and the \"Set Passwords\" module is used with \"chpasswd\" directive and \"RANDOM\", the randomly generated password for the relative user is written in clear-text in a file readable by any existing user of the system. The highest threat from this vulnerability is to data confidentiality and it may allow a local attacker to log in as another user. \n            STATEMENT: By default the randomly password generated by \"chpasswd\" must be changed on the first login of the user. That means that once a user accesses the system for the first time, the random password in the log file cannot be used anymore. However it is possible to configure an extended validity period for the random password, thus the actual impact of this password leak may vary based on the environment and how the systems are configured through cloud-init.",
    "advisory": {
      "from": "secalert@redhat.com",
      "severity": "Moderate",
      "updated": {
        "date": "2022-05-10"
      },
      "cve": [
        {
          "text": "CVE-2021-3429",
          "cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
          "cwe": "CWE-532",
          "href": "https://access.redhat.com/security/cve/CVE-2021-3429",
          "impact": "moderate",
          "public": "20210323"
        }
      ],
      "affected": {
        "resolution": [
          {
            "state": "Out of support scope",
            "component": [
              "cloud-init"
            ]
          }
        ]
      },
      "affected_cpe_list": {
        "cpe": [
          "cpe:/a:redhat:rhel_extras:7",
          "cpe:/a:redhat:rhel_extras_oracle_java:7",
          "cpe:/a:redhat:rhel_extras_rt:7",
          "cpe:/a:redhat:rhel_extras_sap:7",
          "cpe:/a:redhat:rhel_extras_sap_hana:7",
          "cpe:/o:redhat:enterprise_linux:7",
          "cpe:/o:redhat:enterprise_linux:7::client",
          "cpe:/o:redhat:enterprise_linux:7::computenode",
          "cpe:/o:redhat:enterprise_linux:7::container",
          "cpe:/o:redhat:enterprise_linux:7::containers",
          "cpe:/o:redhat:enterprise_linux:7::server",
          "cpe:/o:redhat:enterprise_linux:7::workstation"
        ]
      },
      "issued": {}
    },
    "affected": {}
  },
  "criteria": {
    "operator": "OR",
    "criterias": [
      {
        "operator": "AND",
        "criterions": [
          {
            "test_ref": "oval:com.redhat.cve:tst:20042779005",
            "comment": "Red Hat Enterprise Linux 7 is installed"
          },
          {
            "test_ref": "oval:com.redhat.cve:tst:20213429001",
            "comment": "cloud-init is installed"
          },
          {
            "test_ref": "oval:com.redhat.cve:tst:20213429002",
            "comment": "cloud-init is signed with Red Hat redhatrelease2 key"
          }
        ]
      }
    ],
    "criterions": [
      {
        "test_ref": "oval:com.redhat.cve:tst:20042779006",
        "comment": "Red Hat Enterprise Linux must be installed"
      }
    ]
  }
}
