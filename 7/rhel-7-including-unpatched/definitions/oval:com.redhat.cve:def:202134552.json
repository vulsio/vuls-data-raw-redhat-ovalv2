{
  "id": "oval:com.redhat.cve:def:202134552",
  "version": "636",
  "class": "vulnerability",
  "metadata": {
    "title": "CVE-2021-34552 python-pillow: Buffer overflow in image convert function (moderate)",
    "reference": [
      {
        "ref_id": "CVE-2021-34552",
        "ref_url": "https://access.redhat.com/security/cve/CVE-2021-34552",
        "source": "CVE"
      }
    ],
    "description": "DOCUMENTATION: A flaw was found in python-pillow. This flaw allows an attacker to pass controlled parameters directly into a convert function, triggering a buffer overflow in the \"convert()\" or \"ImagingConvertTransparent()\" functions in Convert.c. The highest threat to this vulnerability is to system availability.\n\nIn Red Hat Quay, a vulnerable version of python-pillow is shipped with quay-registry-container, however the invoice generation feature which uses python-pillow is disabled by default. Therefore impact has been rated Moderate. \n            STATEMENT: Due to the compiler options used, the buffer overflow is detected and the impact is lowered to a crash only. Additionally, the \"mode\" parameter has to be attacker controlled, which is considered a rare case.\n            MITIGATION: To mitigate this flaw on Red Hat Quay, keep the invoice generation feature disabled, as it is by default.\n\nRed Hat Satellite 6.9 customers can apply following hotfix to eliminate the vulnerability warnings.\n* Download python2-daemon-2.1.2-7.1.HFRHBZ1998199.el7sat.noarch.rpm from https://bugzilla.redhat.com/attachment.cgi?id=1819471\n* Stop services:\n# satellite-maintain service stop\n* Upgrade python2-daemon and remove affected package\n# rpm -Uvh python2-daemon-2.1.2-7.1.HFRHBZ1998199.el7sat.noarch.rpm\n# yum remove python-pillow\n* Restart services:\n# satellite-maintain service start\n\nSatellite 6.10 future release is also fixing this.",
    "advisory": {
      "from": "secalert@redhat.com",
      "severity": "Moderate",
      "updated": {
        "date": "2021-11-09"
      },
      "cve": [
        {
          "text": "CVE-2021-34552",
          "cvss3": "5.9/CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "cwe": "CWE-119",
          "href": "https://access.redhat.com/security/cve/CVE-2021-34552",
          "impact": "moderate",
          "public": "20210713"
        }
      ],
      "affected": {
        "resolution": [
          {
            "state": "Out of support scope",
            "component": [
              "python-pillow",
              "python-pillow-devel",
              "python-pillow-doc",
              "python-pillow-qt",
              "python-pillow-sane",
              "python-pillow-tk"
            ]
          }
        ]
      },
      "affected_cpe_list": {
        "cpe": [
          "cpe:/a:redhat:rhel_extras:7",
          "cpe:/a:redhat:rhel_extras_oracle_java:7",
          "cpe:/a:redhat:rhel_extras_rt:7",
          "cpe:/a:redhat:rhel_extras_sap:7",
          "cpe:/a:redhat:rhel_extras_sap_hana:7",
          "cpe:/o:redhat:enterprise_linux:7",
          "cpe:/o:redhat:enterprise_linux:7::client",
          "cpe:/o:redhat:enterprise_linux:7::computenode",
          "cpe:/o:redhat:enterprise_linux:7::container",
          "cpe:/o:redhat:enterprise_linux:7::containers",
          "cpe:/o:redhat:enterprise_linux:7::server",
          "cpe:/o:redhat:enterprise_linux:7::workstation"
        ]
      },
      "issued": {}
    },
    "affected": {}
  },
  "criteria": {
    "operator": "OR",
    "criterias": [
      {
        "operator": "AND",
        "criterias": [
          {
            "operator": "OR",
            "criterias": [
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20141932005",
                    "comment": "python-pillow-qt is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20141932006",
                    "comment": "python-pillow-qt is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20141932009",
                    "comment": "python-pillow is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20141932010",
                    "comment": "python-pillow is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20141932003",
                    "comment": "python-pillow-devel is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20141932004",
                    "comment": "python-pillow-devel is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20141932011",
                    "comment": "python-pillow-doc is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20141932012",
                    "comment": "python-pillow-doc is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20141932001",
                    "comment": "python-pillow-tk is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20141932002",
                    "comment": "python-pillow-tk is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20141932007",
                    "comment": "python-pillow-sane is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20141932008",
                    "comment": "python-pillow-sane is signed with Red Hat redhatrelease2 key"
                  }
                ]
              }
            ]
          }
        ],
        "criterions": [
          {
            "test_ref": "oval:com.redhat.cve:tst:20042779005",
            "comment": "Red Hat Enterprise Linux 7 is installed"
          }
        ]
      }
    ],
    "criterions": [
      {
        "test_ref": "oval:com.redhat.cve:tst:20042779006",
        "comment": "Red Hat Enterprise Linux must be installed"
      }
    ]
  }
}
