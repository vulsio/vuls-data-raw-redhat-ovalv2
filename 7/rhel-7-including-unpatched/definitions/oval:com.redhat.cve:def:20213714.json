{
  "id": "oval:com.redhat.cve:def:20213714",
  "version": "636",
  "class": "vulnerability",
  "metadata": {
    "title": "Remote Page Deduplication Attacks (moderate)",
    "reference": [
      {
        "ref_id": "CVE-2021-3714",
        "ref_url": "https://access.redhat.com/security/cve/CVE-2021-3714",
        "source": "CVE"
      }
    ],
    "description": "DOCUMENTATION: A flaw was found in the Linux kernels memory deduplication mechanism. Previous work has shown that memory deduplication can be attacked via a local exploitation mechanism. The same technique can be used if an attacker can upload page sized files and detect the change in access time from a networked service to determine if the page has been merged. \n            STATEMENT: This issue affects the versions of the Linux Kernel as shipped with Red Hat Enterprise Linux 6,7 and 8. Red Hat Product Security has rated this issue as having Moderate security impact. Additionally a workaround is available. A future update may address this issue. For additional information, refer to the Issue Severity Classification: https://access.redhat.com/security/updates/classification/.\n            MITIGATION: The  mitigation shown below has a potentially significant impact on system performance and stability. It should be carefully tested prior to deployment:\n\n- Deactivation of memory deduplication \n\nDeactivating memory deduplication will effectively mitigate all attack vectors. This measure unfortunately eliminates all the highly appreciated benefits of memory deduplication, namely the increase of operational cost-effectiveness through inter-VM memory sharing.  This will cause an increase in the amount of memory required and in some situations may adversely impact performance (e.g. due to slower swap space being used). It is recommended that customers test this workaround before using it in production.  See https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/virtualization_tuning_and_optimization_guide/sect-ksm-deactivating_ksm for how to disable KSM from Red Hat Enterprise Linux 6 and newer.\n\n- Disabling services and firewall rules.\n\nThe attack uses the response time of services on the system.  By limiting access to services an attacker must connect to the service to successful carry out the exploit.  Reducing the number of systems that are allowed to connect to the service will prevent an attack from working when launched outside an allowed ranges.  While this does not prevent an attack from working, it will reduce the amount of systems that an attacker can launch an attack from.",
    "advisory": {
      "from": "secalert@redhat.com",
      "severity": "Moderate",
      "updated": {
        "date": "2023-09-26"
      },
      "cve": [
        {
          "text": "CVE-2021-3714",
          "cvss3": "5.8/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N",
          "cwe": "CWE-200",
          "href": "https://access.redhat.com/security/cve/CVE-2021-3714",
          "impact": "moderate",
          "public": "20211116:1400"
        }
      ],
      "affected": {
        "resolution": [
          {
            "state": "Affected",
            "component": [
              "bpftool",
              "kernel",
              "kernel-abi-whitelists",
              "kernel-bootwrapper",
              "kernel-debug",
              "kernel-debug-devel",
              "kernel-devel",
              "kernel-doc",
              "kernel-headers",
              "kernel-kdump",
              "kernel-kdump-devel",
              "kernel-rt",
              "kernel-rt-debug",
              "kernel-rt-debug-devel",
              "kernel-rt-debug-kvm",
              "kernel-rt-devel",
              "kernel-rt-doc",
              "kernel-rt-kvm",
              "kernel-rt-trace",
              "kernel-rt-trace-devel",
              "kernel-rt-trace-kvm",
              "kernel-tools",
              "kernel-tools-libs",
              "kernel-tools-libs-devel",
              "perf",
              "python-perf"
            ]
          }
        ]
      },
      "affected_cpe_list": {
        "cpe": [
          "cpe:/a:redhat:rhel_extras:7",
          "cpe:/a:redhat:rhel_extras_oracle_java:7",
          "cpe:/a:redhat:rhel_extras_rt:7",
          "cpe:/a:redhat:rhel_extras_sap:7",
          "cpe:/a:redhat:rhel_extras_sap_hana:7",
          "cpe:/o:redhat:enterprise_linux:7",
          "cpe:/o:redhat:enterprise_linux:7::client",
          "cpe:/o:redhat:enterprise_linux:7::computenode",
          "cpe:/o:redhat:enterprise_linux:7::server",
          "cpe:/o:redhat:enterprise_linux:7::workstation"
        ]
      },
      "issued": {}
    },
    "affected": {}
  },
  "criteria": {
    "operator": "OR",
    "criterias": [
      {
        "operator": "AND",
        "criterias": [
          {
            "operator": "OR",
            "criterias": [
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20137446045",
                    "comment": "kernel-rt-kvm is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20137446046",
                    "comment": "kernel-rt-kvm is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542013",
                    "comment": "kernel-bootwrapper is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542014",
                    "comment": "kernel-bootwrapper is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542027",
                    "comment": "kernel-tools is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542028",
                    "comment": "kernel-tools is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542001",
                    "comment": "kernel-debug-devel is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542002",
                    "comment": "kernel-debug-devel is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20137446001",
                    "comment": "kernel-rt-doc is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20137446002",
                    "comment": "kernel-rt-doc is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20137446009",
                    "comment": "kernel-rt-debug-kvm is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20137446010",
                    "comment": "kernel-rt-debug-kvm is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20137446051",
                    "comment": "kernel-rt-trace is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20137446052",
                    "comment": "kernel-rt-trace is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542025",
                    "comment": "kernel is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542026",
                    "comment": "kernel is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542003",
                    "comment": "kernel-debug is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542004",
                    "comment": "kernel-debug is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20137446027",
                    "comment": "kernel-rt is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20137446028",
                    "comment": "kernel-rt is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542021",
                    "comment": "python-perf is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542022",
                    "comment": "python-perf is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542019",
                    "comment": "kernel-kdump-devel is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542020",
                    "comment": "kernel-kdump-devel is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542011",
                    "comment": "perf is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542012",
                    "comment": "perf is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20137446031",
                    "comment": "kernel-rt-trace-devel is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20137446032",
                    "comment": "kernel-rt-trace-devel is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542005",
                    "comment": "kernel-doc is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542006",
                    "comment": "kernel-doc is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542009",
                    "comment": "bpftool is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542010",
                    "comment": "bpftool is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542007",
                    "comment": "kernel-kdump is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542008",
                    "comment": "kernel-kdump is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20137446021",
                    "comment": "kernel-rt-debug is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20137446022",
                    "comment": "kernel-rt-debug is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542029",
                    "comment": "kernel-tools-libs is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542030",
                    "comment": "kernel-tools-libs is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542031",
                    "comment": "kernel-headers is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542032",
                    "comment": "kernel-headers is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20137446017",
                    "comment": "kernel-rt-trace-kvm is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20137446018",
                    "comment": "kernel-rt-trace-kvm is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20137446015",
                    "comment": "kernel-rt-devel is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20137446016",
                    "comment": "kernel-rt-devel is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542023",
                    "comment": "kernel-abi-whitelists is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542024",
                    "comment": "kernel-abi-whitelists is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542017",
                    "comment": "kernel-tools-libs-devel is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542018",
                    "comment": "kernel-tools-libs-devel is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542015",
                    "comment": "kernel-devel is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20124542016",
                    "comment": "kernel-devel is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20137446043",
                    "comment": "kernel-rt-debug-devel is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20137446044",
                    "comment": "kernel-rt-debug-devel is signed with Red Hat redhatrelease2 key"
                  }
                ]
              }
            ]
          }
        ],
        "criterions": [
          {
            "test_ref": "oval:com.redhat.cve:tst:20042779005",
            "comment": "Red Hat Enterprise Linux 7 is installed"
          }
        ]
      }
    ],
    "criterions": [
      {
        "test_ref": "oval:com.redhat.cve:tst:20042779006",
        "comment": "Red Hat Enterprise Linux must be installed"
      }
    ]
  }
}
