{
  "id": "oval:com.redhat.rhsa:def:20161486",
  "version": "641",
  "class": "patch",
  "metadata": {
    "title": "RHSA-2016:1486: samba security and bug fix update (Moderate)",
    "reference": [
      {
        "ref_id": "RHSA-2016:1486",
        "ref_url": "https://access.redhat.com/errata/RHSA-2016:1486",
        "source": "RHSA"
      },
      {
        "ref_id": "CVE-2016-2119",
        "ref_url": "https://access.redhat.com/security/cve/CVE-2016-2119",
        "source": "CVE"
      }
    ],
    "description": "Samba is an open-source implementation of the Server Message Block (SMB) protocol and the related Common Internet File System (CIFS) protocol, which allow PC-compatible machines to share files, printers, and various information.\n\nSecurity Fix(es):\n\n* A flaw was found in the way Samba initiated signed DCE/RPC connections. A\nman-in-the-middle attacker could use this flaw to downgrade the connection to not use signing and therefore impersonate the server. (CVE-2016-2119)\n\nRed Hat would like to thank the Samba project for reporting this issue. Upstream acknowledges Stefan Metzmacher as the original reporter.\n\nBug Fix(es):\n\n* Previously, the \"net\" command in some cases failed to join the client to Active Directory (AD) because the permissions setting prevented modification of the supported Kerberos encryption type LDAP attribute. With this update, Samba has been fixed to allow joining an AD domain as a user. In addition, Samba now uses the machine account credentials to set up the Kerberos encryption types within AD for the joined machine. As a result, using \"net\" to join a domain now works more reliably. (BZ#1351260)\n\n* Previously, the idmap_hash module worked incorrectly when it was used together with other modules. As a consequence, user and group IDs were not mapped properly. A patch has been applied to skip already configured modules. Now, the hash module can be used as the default idmap configuration back end and IDs are resolved correctly. (BZ#1350759)",
    "advisory": {
      "from": "secalert@redhat.com",
      "severity": "Moderate",
      "updated": {
        "date": "2016-07-26"
      },
      "cve": [
        {
          "text": "CVE-2016-2119",
          "cvss3": "7.5/CVSS:3.0/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "href": "https://access.redhat.com/security/cve/CVE-2016-2119",
          "impact": "moderate",
          "public": "20160707",
          "cvss2": "5.4/AV:A/AC:M/Au:N/C:P/I:P/A:P"
        }
      ],
      "affected": {},
      "affected_cpe_list": {
        "cpe": [
          "cpe:/a:redhat:rhel_extras_sap_e4s:7.6",
          "cpe:/a:redhat:rhel_extras_sap_hana_e4s:7.6",
          "cpe:/o:redhat:rhel_e4s:7.6",
          "cpe:/o:redhat:rhel_e4s:7.6::server"
        ]
      },
      "rights": "Copyright 2016 Red Hat, Inc.",
      "issued": {
        "date": "2016-07-26"
      },
      "bugzilla": [
        {
          "text": "CVE-2016-2119 samba: Client side SMB2/3 required signing can be downgraded",
          "href": "https://bugzilla.redhat.com/1351955",
          "id": "1351955"
        }
      ]
    },
    "affected": {
      "family": "unix",
      "platform": [
        "Red Hat Enterprise Linux 7"
      ]
    }
  },
  "criteria": {
    "operator": "OR",
    "criterias": [
      {
        "operator": "AND",
        "criterias": [
          {
            "operator": "OR",
            "criterias": [
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20161486001",
                    "comment": "ctdb is earlier than 0:4.2.10-7.el7_2"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20152258002",
                    "comment": "ctdb is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20161486003",
                    "comment": "ctdb-devel is earlier than 0:4.2.10-7.el7_2"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20152258004",
                    "comment": "ctdb-devel is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20161486005",
                    "comment": "ctdb-tests is earlier than 0:4.2.10-7.el7_2"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20152258006",
                    "comment": "ctdb-tests is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20161486007",
                    "comment": "libsmbclient is earlier than 0:4.2.10-7.el7_2"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20152258008",
                    "comment": "libsmbclient is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20161486009",
                    "comment": "libsmbclient-devel is earlier than 0:4.2.10-7.el7_2"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20152258010",
                    "comment": "libsmbclient-devel is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20161486011",
                    "comment": "libwbclient is earlier than 0:4.2.10-7.el7_2"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20152258012",
                    "comment": "libwbclient is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20161486013",
                    "comment": "libwbclient-devel is earlier than 0:4.2.10-7.el7_2"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20152258014",
                    "comment": "libwbclient-devel is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20161486015",
                    "comment": "samba is earlier than 0:4.2.10-7.el7_2"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20152258016",
                    "comment": "samba is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20161486017",
                    "comment": "samba-client is earlier than 0:4.2.10-7.el7_2"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20152258018",
                    "comment": "samba-client is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20161486019",
                    "comment": "samba-client-libs is earlier than 0:4.2.10-7.el7_2"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20152258020",
                    "comment": "samba-client-libs is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20161486021",
                    "comment": "samba-common is earlier than 0:4.2.10-7.el7_2"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20152258022",
                    "comment": "samba-common is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20161486023",
                    "comment": "samba-common-libs is earlier than 0:4.2.10-7.el7_2"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20152258024",
                    "comment": "samba-common-libs is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20161486025",
                    "comment": "samba-common-tools is earlier than 0:4.2.10-7.el7_2"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20152258026",
                    "comment": "samba-common-tools is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20161486027",
                    "comment": "samba-dc is earlier than 0:4.2.10-7.el7_2"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20152258028",
                    "comment": "samba-dc is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20161486029",
                    "comment": "samba-dc-libs is earlier than 0:4.2.10-7.el7_2"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20152258030",
                    "comment": "samba-dc-libs is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20161486031",
                    "comment": "samba-devel is earlier than 0:4.2.10-7.el7_2"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20152258032",
                    "comment": "samba-devel is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20161486033",
                    "comment": "samba-libs is earlier than 0:4.2.10-7.el7_2"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20152258034",
                    "comment": "samba-libs is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20161486035",
                    "comment": "samba-pidl is earlier than 0:4.2.10-7.el7_2"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20152258036",
                    "comment": "samba-pidl is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20161486037",
                    "comment": "samba-python is earlier than 0:4.2.10-7.el7_2"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20152258038",
                    "comment": "samba-python is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20161486039",
                    "comment": "samba-test is earlier than 0:4.2.10-7.el7_2"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20152258040",
                    "comment": "samba-test is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20161486041",
                    "comment": "samba-test-devel is earlier than 0:4.2.10-7.el7_2"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20152258042",
                    "comment": "samba-test-devel is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20161486043",
                    "comment": "samba-test-libs is earlier than 0:4.2.10-7.el7_2"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20152258044",
                    "comment": "samba-test-libs is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20161486045",
                    "comment": "samba-vfs-glusterfs is earlier than 0:4.2.10-7.el7_2"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20152258046",
                    "comment": "samba-vfs-glusterfs is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20161486047",
                    "comment": "samba-winbind is earlier than 0:4.2.10-7.el7_2"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20152258048",
                    "comment": "samba-winbind is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20161486049",
                    "comment": "samba-winbind-clients is earlier than 0:4.2.10-7.el7_2"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20152258050",
                    "comment": "samba-winbind-clients is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20161486051",
                    "comment": "samba-winbind-krb5-locator is earlier than 0:4.2.10-7.el7_2"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20152258052",
                    "comment": "samba-winbind-krb5-locator is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20161486053",
                    "comment": "samba-winbind-modules is earlier than 0:4.2.10-7.el7_2"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20152258054",
                    "comment": "samba-winbind-modules is signed with Red Hat redhatrelease2 key"
                  }
                ]
              }
            ]
          }
        ],
        "criterions": [
          {
            "test_ref": "oval:com.redhat.rhba:tst:20150364027",
            "comment": "Red Hat Enterprise Linux 7 is installed"
          }
        ]
      }
    ],
    "criterions": [
      {
        "test_ref": "oval:com.redhat.rhba:tst:20150364028",
        "comment": "Red Hat Enterprise Linux must be installed"
      }
    ]
  }
}
