{
  "id": "oval:com.redhat.cve:def:202131607",
  "version": "636",
  "class": "vulnerability",
  "metadata": {
    "title": "CVE-2021-31607 salt: Command injection in the snapper module (moderate)",
    "reference": [
      {
        "ref_id": "CVE-2021-31607",
        "ref_url": "https://access.redhat.com/security/cve/CVE-2021-31607",
        "source": "CVE"
      }
    ],
    "description": "DOCUMENTATION: A flaw was found in Salt. A command injection vulnerability occurs in the snapper module that allows local privilege escalation on a minion. This attack requires the creation of a file with a pathname that is backed up by snapper, with the master calling the snapper.diff function. Snapper.diff executes the popen unsafely. The highest threat from this vulnerability is to confidentiality, integrity, as well as system availability.",
    "advisory": {
      "from": "secalert@redhat.com",
      "severity": "Moderate",
      "updated": {
        "date": "2021-06-22"
      },
      "cve": [
        {
          "text": "CVE-2021-31607",
          "cvss3": "7.8/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "cwe": "CWE-77",
          "href": "https://access.redhat.com/security/cve/CVE-2021-31607",
          "impact": "moderate",
          "public": "20210423"
        }
      ],
      "affected": {
        "resolution": [
          {
            "state": "Out of support scope",
            "component": [
              "salt",
              "salt-minion"
            ]
          }
        ]
      },
      "affected_cpe_list": {
        "cpe": [
          "cpe:/a:redhat:ceph_storage:2",
          "cpe:/a:redhat:ceph_storage:2::el7"
        ]
      },
      "issued": {}
    },
    "affected": {}
  },
  "criteria": {
    "operator": "OR",
    "criterias": [
      {
        "operator": "AND",
        "criterias": [
          {
            "operator": "OR",
            "criterias": [
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20169639001",
                    "comment": "salt is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20169639002",
                    "comment": "salt is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20169639003",
                    "comment": "salt-minion is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20169639004",
                    "comment": "salt-minion is signed with Red Hat redhatrelease2 key"
                  }
                ]
              }
            ]
          }
        ],
        "criterions": [
          {
            "test_ref": "oval:com.redhat.cve:tst:20137459003",
            "comment": "Red Hat Enterprise Linux 7 is installed"
          }
        ]
      }
    ],
    "criterions": [
      {
        "test_ref": "oval:com.redhat.cve:tst:20137459004",
        "comment": "Red Hat Enterprise Linux must be installed"
      }
    ]
  }
}
