{
	"id": "oval:com.redhat.rhsa:def:20182613",
	"version": "648",
	"class": "patch",
	"metadata": {
		"title": "RHSA-2018:2613: samba security, bug fix and enhancement update (Moderate)",
		"reference": [
			{
				"ref_id": "RHSA-2018:2613",
				"ref_url": "https://access.redhat.com/errata/RHSA-2018:2613",
				"source": "RHSA"
			},
			{
				"ref_id": "CVE-2018-1050",
				"ref_url": "https://access.redhat.com/security/cve/CVE-2018-1050",
				"source": "CVE"
			},
			{
				"ref_id": "CVE-2018-10858",
				"ref_url": "https://access.redhat.com/security/cve/CVE-2018-10858",
				"source": "CVE"
			},
			{
				"ref_id": "CVE-2018-1139",
				"ref_url": "https://access.redhat.com/security/cve/CVE-2018-1139",
				"source": "CVE"
			}
		],
		"description": "Samba is an open-source implementation of the Server Message Block (SMB) protocol and the related Common Internet File System (CIFS) protocol, which allow PC-compatible machines to share files, printers, and various information.\n\nSecurity Fix(es):\n\n* samba: Weak authentication protocol regression (CVE-2018-1139)\n\n* samba: Insufficient input validation in libsmbclient (CVE-2018-10858)\n\n* samba: Null pointer indirection in printer server process (CVE-2018-1050)\n\nRed Hat would like to thank the Samba project for reporting CVE-2018-1139 and CVE-2018-1050. Upstream acknowledges Vivek Das (Red Hat) as the original reporter of CVE-2018-1139.\n\nFor more details about the security issue(s), including the impact, a CVSS score, and other related information, refer to the CVE page(s) listed in the References section.\n\nBug Fix(es):\n\n* Previously, sharing a subdirectory of a Gluster volume failed with an I/O error when the shadow_copy2 vfs object was specified. This occurred because Gluster volumes are remote file systems, and shadow_copy2 only detected share paths in the local file system. This update forces the value of shadow:mountpath to '/', skipping the code related to mount point detection, and preventing this problem. However, this fix requires that the glusterfs vfs object is listed after the shadow_copy2 vfs object in the smb.conf file. (BZ#1379444)\n\n* As of Red Hat Gluster Storage 3.4, the libldb package is no longer shipped as an independent package in the Red Hat Gluster Storage Samba channel. The capabilities of the libldb package are now provided by a combination of the samba-client and samba-client-libs packages. In addition, the sub-packages previously provided by libldb are now provided by the samba-client and samba-client-libs packages. The samba-client sub-package provides ldb-tools, and the samba-client-libs sub-package provides pyldb. (BZ#1592794)\n\nEnhancement(s):\n\n* Red Hat Gluster Storage volumes exported using SMB can now be mounted on macOS clients using Finder. Configuration instructions are provided as part of the Red Hat Gluster Storage 3.4 documentation. (BZ#1446125)\n\nRed Hat strongly recommends upgrading to these updated packages.",
		"advisory": {
			"from": "secalert@redhat.com",
			"severity": "Moderate",
			"updated": {
				"date": "2018-09-04"
			},
			"cve": [
				{
					"text": "CVE-2018-1050",
					"cvss3": "4.3/CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
					"cwe": "CWE-476",
					"href": "https://access.redhat.com/security/cve/CVE-2018-1050",
					"impact": "low",
					"public": "20180313"
				},
				{
					"text": "CVE-2018-10858",
					"cvss3": "4.3/CVSS:3.0/AV:N/AC:L/PR:H/UI:R/S:U/C:L/I:L/A:L",
					"cwe": "CWE-20",
					"href": "https://access.redhat.com/security/cve/CVE-2018-10858",
					"impact": "moderate",
					"public": "20180816"
				},
				{
					"text": "CVE-2018-1139",
					"cvss3": "5.4/CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N",
					"cwe": "CWE-20",
					"href": "https://access.redhat.com/security/cve/CVE-2018-1139",
					"impact": "moderate",
					"public": "20180816"
				}
			],
			"affected": {},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/a:redhat:storage:3",
					"cpe:/a:redhat:storage:3.1",
					"cpe:/a:redhat:storage:3.1:bigdata:el7",
					"cpe:/a:redhat:storage:3.1:nagios:el7",
					"cpe:/a:redhat:storage:3.1:nfs:el7",
					"cpe:/a:redhat:storage:3.1:samba:el7",
					"cpe:/a:redhat:storage:3.1:server:el7",
					"cpe:/a:redhat:storage:3.1:splunk:el7",
					"cpe:/a:redhat:storage:3.2",
					"cpe:/a:redhat:storage:3.2:nagios:el7",
					"cpe:/a:redhat:storage:3.2:nfs:el7",
					"cpe:/a:redhat:storage:3.2:samba:el7",
					"cpe:/a:redhat:storage:3.2:server:el7",
					"cpe:/a:redhat:storage:3.3",
					"cpe:/a:redhat:storage:3.3:na:el7",
					"cpe:/a:redhat:storage:3.3:nagios:el7",
					"cpe:/a:redhat:storage:3.3:nfs:el7",
					"cpe:/a:redhat:storage:3.3:samba:el7",
					"cpe:/a:redhat:storage:3.3:server:el7",
					"cpe:/a:redhat:storage:3.3:wa:el7",
					"cpe:/a:redhat:storage:3.4",
					"cpe:/a:redhat:storage:3.4:na:el7",
					"cpe:/a:redhat:storage:3.4:nfs:el7",
					"cpe:/a:redhat:storage:3.4:samba:el7",
					"cpe:/a:redhat:storage:3.4:server:el7",
					"cpe:/a:redhat:storage:3.4:wa:el7",
					"cpe:/a:redhat:storage:3.5",
					"cpe:/a:redhat:storage:3.5:na:el7",
					"cpe:/a:redhat:storage:3.5:nfs:el7",
					"cpe:/a:redhat:storage:3.5:samba:el7",
					"cpe:/a:redhat:storage:3.5:server:el7",
					"cpe:/a:redhat:storage:3.5:wa:el7",
					"cpe:/a:redhat:storage:3:client:el7"
				]
			},
			"rights": "Copyright 2018 Red Hat, Inc.",
			"issued": {
				"date": "2018-09-04"
			},
			"bugzilla": [
				{
					"text": "samba: NULL pointer dereference in printer server process",
					"href": "https://bugzilla.redhat.com/1538771",
					"id": "1538771"
				},
				{
					"text": "samba: Weak authentication protocol regression",
					"href": "https://bugzilla.redhat.com/1589651",
					"id": "1589651"
				},
				{
					"text": "samba: Insufficient input validation in libsmbclient",
					"href": "https://bugzilla.redhat.com/1612805",
					"id": "1612805"
				}
			]
		},
		"affected": {
			"family": "unix",
			"platform": [
				"Red Hat Gluster Storage 3.4 for RHEL 7"
			]
		}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterias": [
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613001",
										"comment": "libtalloc is earlier than 0:2.1.11-1.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160614020",
										"comment": "libtalloc is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613003",
										"comment": "libtalloc-devel is earlier than 0:2.1.11-1.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160614022",
										"comment": "libtalloc-devel is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613005",
										"comment": "pytalloc is earlier than 0:2.1.11-1.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160614024",
										"comment": "pytalloc is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613007",
										"comment": "pytalloc-devel is earlier than 0:2.1.11-1.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160614026",
										"comment": "pytalloc-devel is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613009",
										"comment": "libtdb is earlier than 0:1.3.15-4.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160614012",
										"comment": "libtdb is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613011",
										"comment": "libtdb-devel is earlier than 0:1.3.15-4.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160614014",
										"comment": "libtdb-devel is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613013",
										"comment": "python-tdb is earlier than 0:1.3.15-4.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160614016",
										"comment": "python-tdb is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613015",
										"comment": "tdb-tools is earlier than 0:1.3.15-4.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160614018",
										"comment": "tdb-tools is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613017",
										"comment": "libtevent is earlier than 0:0.9.35-1.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160614028",
										"comment": "libtevent is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613019",
										"comment": "libtevent-devel is earlier than 0:0.9.35-1.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160614030",
										"comment": "libtevent-devel is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613021",
										"comment": "python-tevent is earlier than 0:0.9.35-1.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160614032",
										"comment": "python-tevent is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613023",
										"comment": "ctdb is earlier than 0:4.7.5-110.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160016002",
										"comment": "ctdb is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613025",
										"comment": "libsmbclient is earlier than 0:4.7.5-110.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160016008",
										"comment": "libsmbclient is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613027",
										"comment": "libsmbclient-devel is earlier than 0:4.7.5-110.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160016010",
										"comment": "libsmbclient-devel is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613029",
										"comment": "libwbclient is earlier than 0:4.7.5-110.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160016012",
										"comment": "libwbclient is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613031",
										"comment": "libwbclient-devel is earlier than 0:4.7.5-110.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160016014",
										"comment": "libwbclient-devel is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613033",
										"comment": "samba is earlier than 0:4.7.5-110.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160016016",
										"comment": "samba is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613035",
										"comment": "samba-client is earlier than 0:4.7.5-110.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160016018",
										"comment": "samba-client is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613037",
										"comment": "samba-client-libs is earlier than 0:4.7.5-110.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160016020",
										"comment": "samba-client-libs is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613039",
										"comment": "samba-common is earlier than 0:4.7.5-110.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160016022",
										"comment": "samba-common is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613041",
										"comment": "samba-common-libs is earlier than 0:4.7.5-110.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160016024",
										"comment": "samba-common-libs is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613043",
										"comment": "samba-common-tools is earlier than 0:4.7.5-110.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160016026",
										"comment": "samba-common-tools is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613045",
										"comment": "samba-dc is earlier than 0:4.7.5-110.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160016028",
										"comment": "samba-dc is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613047",
										"comment": "samba-dc-libs is earlier than 0:4.7.5-110.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160016030",
										"comment": "samba-dc-libs is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613049",
										"comment": "samba-devel is earlier than 0:4.7.5-110.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160016032",
										"comment": "samba-devel is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613051",
										"comment": "samba-krb5-printing is earlier than 0:4.7.5-110.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20170495032",
										"comment": "samba-krb5-printing is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613053",
										"comment": "samba-libs is earlier than 0:4.7.5-110.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160016034",
										"comment": "samba-libs is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613055",
										"comment": "samba-pidl is earlier than 0:4.7.5-110.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160016036",
										"comment": "samba-pidl is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613057",
										"comment": "samba-python is earlier than 0:4.7.5-110.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160016038",
										"comment": "samba-python is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613059",
										"comment": "samba-vfs-glusterfs is earlier than 0:4.7.5-110.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160016046",
										"comment": "samba-vfs-glusterfs is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613061",
										"comment": "samba-winbind is earlier than 0:4.7.5-110.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160016048",
										"comment": "samba-winbind is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613063",
										"comment": "samba-winbind-clients is earlier than 0:4.7.5-110.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160016050",
										"comment": "samba-winbind-clients is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613065",
										"comment": "samba-winbind-krb5-locator is earlier than 0:4.7.5-110.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160016052",
										"comment": "samba-winbind-krb5-locator is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20182613067",
										"comment": "samba-winbind-modules is earlier than 0:4.7.5-110.el7rhgs"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20160016054",
										"comment": "samba-winbind-modules is signed with Red Hat redhatrelease2 key"
									}
								]
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:com.redhat.cve:tst:20087313007",
						"comment": "Red Hat Enterprise Linux 7 is installed"
					}
				]
			}
		],
		"criterions": [
			{
				"test_ref": "oval:com.redhat.cve:tst:20087313008",
				"comment": "Red Hat Enterprise Linux must be installed"
			}
		]
	}
}
