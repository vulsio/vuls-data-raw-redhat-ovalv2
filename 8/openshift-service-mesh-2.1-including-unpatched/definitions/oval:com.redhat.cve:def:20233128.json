{
  "id": "oval:com.redhat.cve:def:20233128",
  "version": "636",
  "class": "vulnerability",
  "metadata": {
    "title": "grafana: account takeover possible when using Azure AD OAuth (critical)",
    "reference": [
      {
        "ref_id": "CVE-2023-3128",
        "ref_url": "https://access.redhat.com/security/cve/CVE-2023-3128",
        "source": "CVE"
      }
    ],
    "description": "DOCUMENTATION: A flaw was found in Grafana, which validates Azure AD accounts based on the email claim. On Azure AD, the profile email field is not unique across Azure AD tenants, which enables Grafana account takeover and authentication bypass when Azure AD OAuth is configured with a multi-tenant AzureAD OAuth application.Â This may allow an attacker to gain complete control of the user's account, including access to private customer data and sensitive information. \n            STATEMENT: For Red Hat Enterprise Linux, Azure Active Directory access is not supported, therefore it is disabled by default in the Grafana configuration file located at /etc/grafana/grafana.ini in the Azure AD section. In the unlikely event that someone has enabled Azure Active Directory access, they have the option to revert it back to the default state of disabling it.\n            MITIGATION: We recommend disabling Active Directory in the Grafana configuration file until a fix is provided.",
    "advisory": {
      "from": "secalert@redhat.com",
      "severity": "Critical",
      "updated": {
        "date": "2023-11-10"
      },
      "cve": [
        {
          "text": "CVE-2023-3128",
          "cvss3": "9.4/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L",
          "cwe": "CWE-305",
          "href": "https://access.redhat.com/security/cve/CVE-2023-3128",
          "impact": "critical",
          "public": "20230622"
        }
      ],
      "affected": {
        "resolution": [
          {
            "state": "Will not fix",
            "component": [
              "servicemesh-grafana"
            ]
          }
        ]
      },
      "affected_cpe_list": {
        "cpe": [
          "cpe:/a:redhat:service_mesh:2.1",
          "cpe:/a:redhat:service_mesh:2.1::el8"
        ]
      },
      "issued": {}
    },
    "affected": {}
  },
  "criteria": {
    "operator": "OR",
    "criterias": [
      {
        "operator": "AND",
        "criterions": [
          {
            "test_ref": "oval:com.redhat.cve:tst:202036604003",
            "comment": "Red Hat Enterprise Linux 8 is installed"
          },
          {
            "test_ref": "oval:com.redhat.cve:tst:202036627001",
            "comment": "servicemesh-grafana is installed"
          },
          {
            "test_ref": "oval:com.redhat.cve:tst:202036627002",
            "comment": "servicemesh-grafana is signed with Red Hat redhatrelease2 key"
          }
        ]
      }
    ],
    "criterions": [
      {
        "test_ref": "oval:com.redhat.cve:tst:202036604004",
        "comment": "Red Hat Enterprise Linux must be installed"
      }
    ]
  }
}
