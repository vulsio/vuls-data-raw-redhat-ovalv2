{
	"id": "oval:com.redhat.cve:def:20213807",
	"version": "636",
	"class": "vulnerability",
	"metadata": {
		"title": "Regular expression denial of service (ReDoS) matching ANSI escape codes (moderate)",
		"reference": [
			{
				"ref_id": "CVE-2021-3807",
				"ref_url": "https://access.redhat.com/security/cve/CVE-2021-3807",
				"source": "CVE"
			}
		],
		"description": "DOCUMENTATION: A regular expression denial of service (ReDoS) vulnerability was found in nodejs-ansi-regex. This could possibly cause an application using ansi-regex to use an excessive amount of CPU time when matching crafted ANSI escape codes. \n            STATEMENT: This flaw requires crafted invalid ANSI escape codes in order to be exploited and only allows for denial of service of applications on the client side, hence the impact has been rated as Moderate.\n\nIn Red Hat Virtualization and Red Hat Quay some components use a vulnerable version of ansi-regex. However, all frontend code is executed on the client side. As the maximum impact of this vulnerability is denial of service in the client, the vulnerability is rated Moderate for those products.\n\nOpenShift Container Platform 4 (OCP) ships affected version of ansi-regex in the ose-metering-hadoop container, however the metering operator is deprecated since 4.6[1]. This issue is not currently planned to be addressed in future updates and hence hadoop container has been marked as 'will not fix'.\n\nAdvanced Cluster Management for Kubernetes (RHACM) ships the affected version of ansi-regex in several containers, however the impact of this vulnerability is deemed low as it would result in an authenticated slowing down their own user interface. \n\n[1] https://docs.openshift.com/container-platform/4.6/metering/metering-about-metering.html",
		"advisory": {
			"from": "secalert@redhat.com",
			"severity": "Moderate",
			"updated": {
				"date": "2023-09-01"
			},
			"cve": [
				{
					"text": "CVE-2021-3807",
					"cvss3": "7.5/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
					"cwe": "CWE-400",
					"href": "https://access.redhat.com/security/cve/CVE-2021-3807",
					"impact": "moderate",
					"public": "20210917"
				}
			],
			"affected": {
				"resolution": [
					{
						"state": "Affected",
						"component": [
							"nodejs:12/nodejs",
							"nodejs:12/nodejs-devel",
							"nodejs:12/nodejs-docs",
							"nodejs:12/nodejs-full-i18n",
							"nodejs:12/nodejs-nodemon",
							"nodejs:12/nodejs-packaging",
							"nodejs:12/nodejs-packaging-bundler",
							"nodejs:12/npm"
						]
					},
					{
						"state": "Will not fix",
						"component": [
							"nodejs:12/nodejs-nodemon"
						]
					}
				]
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/a:redhat:enterprise_linux:8",
					"cpe:/a:redhat:enterprise_linux:8::appstream",
					"cpe:/a:redhat:enterprise_linux:8::crb",
					"cpe:/a:redhat:enterprise_linux:8::highavailability",
					"cpe:/a:redhat:enterprise_linux:8::nfv",
					"cpe:/a:redhat:enterprise_linux:8::realtime",
					"cpe:/a:redhat:enterprise_linux:8::resilientstorage",
					"cpe:/a:redhat:enterprise_linux:8::sap",
					"cpe:/a:redhat:enterprise_linux:8::sap_hana",
					"cpe:/a:redhat:enterprise_linux:8::supplementary",
					"cpe:/o:redhat:enterprise_linux:8",
					"cpe:/o:redhat:enterprise_linux:8::baseos"
				]
			},
			"issued": {}
		},
		"affected": {}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterias": [
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201715897015",
										"comment": "nodejs-nodemon is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201715897016",
										"comment": "nodejs-nodemon is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201715897009",
										"comment": "nodejs-docs is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201715897010",
										"comment": "nodejs-docs is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201715897003",
										"comment": "npm is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201715897004",
										"comment": "npm is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202123343005",
										"comment": "nodejs-packaging-bundler is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202123343006",
										"comment": "nodejs-packaging-bundler is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201715897007",
										"comment": "nodejs is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201715897008",
										"comment": "nodejs is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201715897013",
										"comment": "nodejs-packaging is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201715897014",
										"comment": "nodejs-packaging is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201715897001",
										"comment": "nodejs-devel is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201715897002",
										"comment": "nodejs-devel is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201715897005",
										"comment": "nodejs-full-i18n is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201715897006",
										"comment": "nodejs-full-i18n is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201715897015",
										"comment": "nodejs-nodemon is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201715897016",
										"comment": "nodejs-nodemon is signed with Red Hat redhatrelease2 key"
									}
								]
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:com.redhat.cve:tst:20052541003",
						"comment": "Red Hat Enterprise Linux 8 is installed"
					},
					{
						"test_ref": "oval:com.redhat.cve:tst:202028469004",
						"comment": "Module nodejs:12 is enabled"
					}
				]
			}
		],
		"criterions": [
			{
				"test_ref": "oval:com.redhat.cve:tst:20052541004",
				"comment": "Red Hat Enterprise Linux must be installed"
			}
		]
	}
}
