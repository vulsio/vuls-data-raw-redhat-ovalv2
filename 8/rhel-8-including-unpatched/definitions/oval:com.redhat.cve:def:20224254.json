{
  "id": "oval:com.redhat.cve:def:20224254",
  "version": "636",
  "class": "vulnerability",
  "metadata": {
    "title": "CVE-2022-4254 sssd: libsss_certmap fails to sanitise certificate data used in LDAP filters (important)",
    "reference": [
      {
        "ref_id": "CVE-2022-4254",
        "ref_url": "https://access.redhat.com/security/cve/CVE-2022-4254",
        "source": "CVE"
      }
    ],
    "description": "DOCUMENTATION: A vulnerability was found in SSSD, in the libsss_certmap functionality. PKINIT enables a client to authenticate to the KDC using an X.509 certificate and the corresponding private key, rather than a passphrase or keytab. FreeIPA uses mapping rules to map a certificate presented during a PKINIT authentication request to the corresponding principal. The mapping filter is vulnerable to LDAP filter injection. The search result can be influenced by values in the certificate, which may be attacker controlled. In the most extreme case, an attacker could gain control of the admin account, leading to full domain takeover. \n            STATEMENT: The issue was introduced in SSSD 1.15.3 (when libsss_certmap was introduced) and resolved in SSSD 2.3.1. It only affects versions of SSSD shipped with RHEL-8.2.0.z and lower streams. Later versions are not affected. \n\nFreeIPA is not vulnerable in its default configuration.",
    "advisory": {
      "from": "secalert@redhat.com",
      "severity": "Important",
      "updated": {
        "date": "2023-02-14"
      },
      "cve": [
        {
          "text": "CVE-2022-4254",
          "cvss3": "8.8/CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "cwe": "CWE-90",
          "href": "https://access.redhat.com/security/cve/CVE-2022-4254",
          "impact": "important",
          "public": "20230124"
        }
      ],
      "affected": {
        "resolution": [
          {
            "state": "Affected",
            "component": [
              "libipa_hbac",
              "libsss_autofs",
              "libsss_certmap",
              "libsss_idmap",
              "libsss_nss_idmap",
              "libsss_nss_idmap-devel",
              "libsss_simpleifp",
              "libsss_sudo",
              "python3-libipa_hbac",
              "python3-libsss_nss_idmap",
              "python3-sss",
              "python3-sss-murmur",
              "python3-sssdconfig",
              "sssd",
              "sssd-ad",
              "sssd-client",
              "sssd-common",
              "sssd-common-pac",
              "sssd-dbus",
              "sssd-debugsource",
              "sssd-ipa",
              "sssd-kcm",
              "sssd-krb5",
              "sssd-krb5-common",
              "sssd-ldap",
              "sssd-libwbclient",
              "sssd-nfs-idmap",
              "sssd-polkit-rules",
              "sssd-proxy",
              "sssd-tools",
              "sssd-winbind-idmap"
            ]
          }
        ]
      },
      "affected_cpe_list": {
        "cpe": [
          "cpe:/a:redhat:enterprise_linux:8",
          "cpe:/a:redhat:enterprise_linux:8::appstream",
          "cpe:/a:redhat:enterprise_linux:8::crb",
          "cpe:/a:redhat:enterprise_linux:8::highavailability",
          "cpe:/a:redhat:enterprise_linux:8::nfv",
          "cpe:/a:redhat:enterprise_linux:8::realtime",
          "cpe:/a:redhat:enterprise_linux:8::resilientstorage",
          "cpe:/a:redhat:enterprise_linux:8::sap",
          "cpe:/a:redhat:enterprise_linux:8::sap_hana",
          "cpe:/a:redhat:enterprise_linux:8::supplementary",
          "cpe:/o:redhat:enterprise_linux:8",
          "cpe:/o:redhat:enterprise_linux:8::baseos"
        ]
      },
      "issued": {}
    },
    "affected": {}
  },
  "criteria": {
    "operator": "OR",
    "criterias": [
      {
        "operator": "AND",
        "criterias": [
          {
            "operator": "OR",
            "criterias": [
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254001",
                    "comment": "sssd-ldap is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254002",
                    "comment": "sssd-ldap is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254003",
                    "comment": "sssd-common is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254004",
                    "comment": "sssd-common is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254005",
                    "comment": "sssd-polkit-rules is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254006",
                    "comment": "sssd-polkit-rules is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254007",
                    "comment": "libsss_certmap is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254008",
                    "comment": "libsss_certmap is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254009",
                    "comment": "python3-libipa_hbac is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254010",
                    "comment": "python3-libipa_hbac is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254011",
                    "comment": "sssd-tools is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254012",
                    "comment": "sssd-tools is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254013",
                    "comment": "sssd-ad is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254014",
                    "comment": "sssd-ad is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254015",
                    "comment": "libsss_nss_idmap is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254016",
                    "comment": "libsss_nss_idmap is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254017",
                    "comment": "python3-sss is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254018",
                    "comment": "python3-sss is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254019",
                    "comment": "sssd-nfs-idmap is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254020",
                    "comment": "sssd-nfs-idmap is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254021",
                    "comment": "sssd is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254022",
                    "comment": "sssd is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254023",
                    "comment": "sssd-client is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254024",
                    "comment": "sssd-client is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254025",
                    "comment": "libipa_hbac is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254026",
                    "comment": "libipa_hbac is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254027",
                    "comment": "sssd-krb5-common is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254028",
                    "comment": "sssd-krb5-common is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254029",
                    "comment": "python3-sss-murmur is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254030",
                    "comment": "python3-sss-murmur is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254031",
                    "comment": "sssd-libwbclient is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254032",
                    "comment": "sssd-libwbclient is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254033",
                    "comment": "sssd-dbus is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254034",
                    "comment": "sssd-dbus is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254035",
                    "comment": "sssd-common-pac is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254036",
                    "comment": "sssd-common-pac is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254037",
                    "comment": "libsss_sudo is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254038",
                    "comment": "libsss_sudo is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254039",
                    "comment": "libsss_nss_idmap-devel is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254040",
                    "comment": "libsss_nss_idmap-devel is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254041",
                    "comment": "sssd-krb5 is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254042",
                    "comment": "sssd-krb5 is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254043",
                    "comment": "sssd-winbind-idmap is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254044",
                    "comment": "sssd-winbind-idmap is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254045",
                    "comment": "libsss_simpleifp is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254046",
                    "comment": "libsss_simpleifp is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254047",
                    "comment": "sssd-debugsource is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254048",
                    "comment": "sssd-debugsource is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254049",
                    "comment": "libsss_idmap is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254050",
                    "comment": "libsss_idmap is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254051",
                    "comment": "sssd-ipa is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254052",
                    "comment": "sssd-ipa is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254053",
                    "comment": "python3-libsss_nss_idmap is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254054",
                    "comment": "python3-libsss_nss_idmap is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254055",
                    "comment": "sssd-kcm is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254056",
                    "comment": "sssd-kcm is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254057",
                    "comment": "sssd-proxy is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254058",
                    "comment": "sssd-proxy is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254059",
                    "comment": "libsss_autofs is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254060",
                    "comment": "libsss_autofs is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254061",
                    "comment": "python3-sssdconfig is installed"
                  },
                  {
                    "test_ref": "oval:com.redhat.cve:tst:20224254062",
                    "comment": "python3-sssdconfig is signed with Red Hat redhatrelease2 key"
                  }
                ]
              }
            ]
          }
        ],
        "criterions": [
          {
            "test_ref": "oval:com.redhat.cve:tst:20052541003",
            "comment": "Red Hat Enterprise Linux 8 is installed"
          }
        ]
      }
    ],
    "criterions": [
      {
        "test_ref": "oval:com.redhat.cve:tst:20052541004",
        "comment": "Red Hat Enterprise Linux must be installed"
      }
    ]
  }
}
