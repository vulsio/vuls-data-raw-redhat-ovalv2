{
	"id": "oval:com.redhat.cve:def:202248969",
	"version": "636",
	"class": "vulnerability",
	"metadata": {
		"title": "kernel: xen-netfront: Fix NULL sring after live migration (moderate)",
		"reference": [
			{
				"ref_id": "CVE-2022-48969",
				"ref_url": "https://access.redhat.com/security/cve/CVE-2022-48969",
				"source": "CVE"
			}
		],
		"description": "DOCUMENTATION: The MITRE CVE dictionary describes this issue as: In the Linux kernel, the following vulnerability has been resolved:\n\nxen-netfront: Fix NULL sring after live migration\n\nA NAPI is setup for each network sring to poll data to kernel\nThe sring with source host is destroyed before live migration and\nnew sring with target host is setup after live migration.\nThe NAPI for the old sring is not deleted until setup new sring\nwith target host after migration. With busy_poll/busy_read enabled,\nthe NAPI can be polled before got deleted when resume VM.\n\nBUG: unable to handle kernel NULL pointer dereference at\n0000000000000008\nIP: xennet_poll+0xae/0xd20\nPGD 0 P4D 0\nOops: 0000 [#1] SMP PTI\nCall Trace:\n finish_task_switch+0x71/0x230\n timerqueue_del+0x1d/0x40\n hrtimer_try_to_cancel+0xb5/0x110\n xennet_alloc_rx_buffers+0x2a0/0x2a0\n napi_busy_loop+0xdb/0x270\n sock_poll+0x87/0x90\n do_sys_poll+0x26f/0x580\n tracing_map_insert+0x1d4/0x2f0\n event_hist_trigger+0x14a/0x260\n\n finish_task_switch+0x71/0x230\n __schedule+0x256/0x890\n recalc_sigpending+0x1b/0x50\n xen_sched_clock+0x15/0x20\n __rb_reserve_next+0x12d/0x140\n ring_buffer_lock_reserve+0x123/0x3d0\n event_triggers_call+0x87/0xb0\n trace_event_buffer_commit+0x1c4/0x210\n xen_clocksource_get_cycles+0x15/0x20\n ktime_get_ts64+0x51/0xf0\n SyS_ppoll+0x160/0x1a0\n SyS_ppoll+0x160/0x1a0\n do_syscall_64+0x73/0x130\n entry_SYSCALL_64_after_hwframe+0x41/0xa6\n...\nRIP: xennet_poll+0xae/0xd20 RSP: ffffb4f041933900\nCR2: 0000000000000008\n---[ end trace f8601785b354351c ]---\n\nxen frontend should remove the NAPIs for the old srings before live\nmigration as the bond srings are destroyed\n\nThere is a tiny window between the srings are set to NULL and\nthe NAPIs are disabled, It is safe as the NAPI threads are still\nfrozen at that time",
		"advisory": {
			"from": "secalert@redhat.com",
			"severity": "Moderate",
			"updated": {
				"date": "2024-10-25"
			},
			"cve": [
				{
					"text": "CVE-2022-48969",
					"cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
					"cwe": "CWE-476",
					"href": "https://access.redhat.com/security/cve/CVE-2022-48969",
					"impact": "moderate",
					"public": "20241021"
				}
			],
			"affected": {
				"resolution": [
					{
						"state": "Affected",
						"component": [
							"bpftool",
							"kernel",
							"kernel-abi-stablelists",
							"kernel-abi-whitelists",
							"kernel-core",
							"kernel-cross-headers",
							"kernel-debug",
							"kernel-debug-core",
							"kernel-debug-devel",
							"kernel-debug-modules",
							"kernel-debug-modules-extra",
							"kernel-debug-modules-internal",
							"kernel-devel",
							"kernel-doc",
							"kernel-headers",
							"kernel-ipaclones-internal",
							"kernel-modules",
							"kernel-modules-extra",
							"kernel-modules-internal",
							"kernel-rt",
							"kernel-rt-core",
							"kernel-rt-debug",
							"kernel-rt-debug-core",
							"kernel-rt-debug-devel",
							"kernel-rt-debug-kvm",
							"kernel-rt-debug-modules",
							"kernel-rt-debug-modules-extra",
							"kernel-rt-debug-modules-internal",
							"kernel-rt-devel",
							"kernel-rt-kvm",
							"kernel-rt-modules",
							"kernel-rt-modules-extra",
							"kernel-rt-modules-internal",
							"kernel-rt-selftests-internal",
							"kernel-selftests-internal",
							"kernel-tools",
							"kernel-tools-libs",
							"kernel-tools-libs-devel",
							"kernel-zfcpdump",
							"kernel-zfcpdump-core",
							"kernel-zfcpdump-devel",
							"kernel-zfcpdump-modules",
							"kernel-zfcpdump-modules-extra",
							"kernel-zfcpdump-modules-internal",
							"perf",
							"python3-perf"
						]
					}
				]
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/a:redhat:enterprise_linux:8",
					"cpe:/a:redhat:enterprise_linux:8::appstream",
					"cpe:/a:redhat:enterprise_linux:8::crb",
					"cpe:/a:redhat:enterprise_linux:8::highavailability",
					"cpe:/a:redhat:enterprise_linux:8::nfv",
					"cpe:/a:redhat:enterprise_linux:8::realtime",
					"cpe:/a:redhat:enterprise_linux:8::resilientstorage",
					"cpe:/a:redhat:enterprise_linux:8::sap",
					"cpe:/a:redhat:enterprise_linux:8::sap_hana",
					"cpe:/a:redhat:enterprise_linux:8::supplementary",
					"cpe:/o:redhat:enterprise_linux:8",
					"cpe:/o:redhat:enterprise_linux:8::baseos"
				]
			},
			"issued": {}
		},
		"affected": {}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterias": [
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594039",
										"comment": "kernel-selftests-internal is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594040",
										"comment": "kernel-selftests-internal is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594007",
										"comment": "kernel-abi-stablelists is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594008",
										"comment": "kernel-abi-stablelists is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862051",
										"comment": "kernel-rt-modules is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862052",
										"comment": "kernel-rt-modules is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862083",
										"comment": "kernel-rt-modules-extra is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862084",
										"comment": "kernel-rt-modules-extra is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594061",
										"comment": "kernel-zfcpdump-devel is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594062",
										"comment": "kernel-zfcpdump-devel is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862041",
										"comment": "kernel-rt-core is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862042",
										"comment": "kernel-rt-core is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594005",
										"comment": "kernel-zfcpdump is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594006",
										"comment": "kernel-zfcpdump is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862075",
										"comment": "kernel-rt-debug-modules is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862076",
										"comment": "kernel-rt-debug-modules is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594051",
										"comment": "kernel-core is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594052",
										"comment": "kernel-core is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594019",
										"comment": "kernel-doc is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594020",
										"comment": "kernel-doc is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862065",
										"comment": "kernel-rt-debug-core is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862066",
										"comment": "kernel-rt-debug-core is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594029",
										"comment": "kernel-debug-modules is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594030",
										"comment": "kernel-debug-modules is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862037",
										"comment": "kernel-rt-selftests-internal is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862038",
										"comment": "kernel-rt-selftests-internal is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594011",
										"comment": "kernel is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594012",
										"comment": "kernel is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594023",
										"comment": "kernel-debug-modules-internal is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594024",
										"comment": "kernel-debug-modules-internal is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594053",
										"comment": "kernel-modules-internal is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594054",
										"comment": "kernel-modules-internal is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862047",
										"comment": "kernel-rt-debug-modules-internal is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862048",
										"comment": "kernel-rt-debug-modules-internal is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862005",
										"comment": "kernel-rt is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862006",
										"comment": "kernel-rt is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594035",
										"comment": "kernel-debug-devel is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594036",
										"comment": "kernel-debug-devel is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862069",
										"comment": "kernel-rt-debug-kvm is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862070",
										"comment": "kernel-rt-debug-kvm is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594003",
										"comment": "kernel-ipaclones-internal is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594004",
										"comment": "kernel-ipaclones-internal is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594047",
										"comment": "kernel-zfcpdump-modules-extra is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594048",
										"comment": "kernel-zfcpdump-modules-extra is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594013",
										"comment": "perf is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594014",
										"comment": "perf is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594017",
										"comment": "kernel-debug is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594018",
										"comment": "kernel-debug is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594021",
										"comment": "kernel-abi-whitelists is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594022",
										"comment": "kernel-abi-whitelists is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594031",
										"comment": "kernel-tools-libs is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594032",
										"comment": "kernel-tools-libs is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862009",
										"comment": "kernel-rt-modules-internal is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862010",
										"comment": "kernel-rt-modules-internal is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862035",
										"comment": "kernel-rt-debug-devel is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862036",
										"comment": "kernel-rt-debug-devel is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862055",
										"comment": "kernel-rt-debug-modules-extra is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862056",
										"comment": "kernel-rt-debug-modules-extra is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594001",
										"comment": "kernel-debug-modules-extra is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594002",
										"comment": "kernel-debug-modules-extra is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594009",
										"comment": "kernel-modules is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594010",
										"comment": "kernel-modules is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594045",
										"comment": "kernel-tools-libs-devel is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594046",
										"comment": "kernel-tools-libs-devel is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594015",
										"comment": "kernel-zfcpdump-core is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594016",
										"comment": "kernel-zfcpdump-core is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862003",
										"comment": "kernel-rt-debug is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862004",
										"comment": "kernel-rt-debug is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594057",
										"comment": "python3-perf is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594058",
										"comment": "python3-perf is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594027",
										"comment": "kernel-debug-core is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594028",
										"comment": "kernel-debug-core is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594025",
										"comment": "kernel-tools is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594026",
										"comment": "kernel-tools is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594059",
										"comment": "kernel-cross-headers is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594060",
										"comment": "kernel-cross-headers is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594055",
										"comment": "kernel-devel is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594056",
										"comment": "kernel-devel is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594043",
										"comment": "kernel-zfcpdump-modules-internal is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594044",
										"comment": "kernel-zfcpdump-modules-internal is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594033",
										"comment": "bpftool is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594034",
										"comment": "bpftool is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594049",
										"comment": "kernel-modules-extra is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594050",
										"comment": "kernel-modules-extra is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862027",
										"comment": "kernel-rt-kvm is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862028",
										"comment": "kernel-rt-kvm is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594041",
										"comment": "kernel-zfcpdump-modules is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594042",
										"comment": "kernel-zfcpdump-modules is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594037",
										"comment": "kernel-headers is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201815594038",
										"comment": "kernel-headers is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862045",
										"comment": "kernel-rt-devel is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201816862046",
										"comment": "kernel-rt-devel is signed with Red Hat redhatrelease2 key"
									}
								]
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:com.redhat.cve:tst:20052541003",
						"comment": "Red Hat Enterprise Linux 8 is installed"
					}
				]
			}
		],
		"criterions": [
			{
				"test_ref": "oval:com.redhat.cve:tst:20052541004",
				"comment": "Red Hat Enterprise Linux must be installed"
			}
		]
	}
}
