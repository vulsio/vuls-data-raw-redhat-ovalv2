{
  "id": "oval:com.redhat.cve:def:202338710",
  "version": "636",
  "class": "vulnerability",
  "metadata": {
    "title": "Invalid IKEv2 REKEY proposal causes restart (moderate)",
    "reference": [
      {
        "ref_id": "CVE-2023-38710",
        "ref_url": "https://access.redhat.com/security/cve/CVE-2023-38710",
        "source": "CVE"
      }
    ],
    "description": "DOCUMENTATION: An assertion failure flaw was found in the Libreswan package that occurs when processing IKEv2 REKEY requests. When an IKEv2 Child SA REKEY packet contains an invalid IPsec protocol ID number of 0 or 1, an error notification INVALID_SPI is sent back. The notify payload's protocol ID is copied from the incoming packet, but the code that verifies outgoing packets fails an assertion that the protocol ID must be ESP (2) or AH(3). This flaw allows a malicious client or attacker to send a malformed IKEv2 REKEY packet, causing a crash and restarting the libreswan pluto daemon. When sent continuously, this could lead to a denial of service attack. \n            STATEMENT: IKEv2 REKEY requests are only processed when received from authenticated peers, limiting the scope of possible attackers to peers who have successfully authenticated.",
    "advisory": {
      "from": "secalert@redhat.com",
      "severity": "Moderate",
      "updated": {
        "date": "2023-11-07"
      },
      "cve": [
        {
          "text": "CVE-2023-38710",
          "cvss3": "6.5/CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
          "cwe": "CWE-617",
          "href": "https://access.redhat.com/security/cve/CVE-2023-38710",
          "impact": "moderate",
          "public": "20230808"
        }
      ],
      "affected": {
        "resolution": [
          {
            "state": "Affected",
            "component": [
              "libreswan"
            ]
          }
        ]
      },
      "affected_cpe_list": {
        "cpe": [
          "cpe:/a:redhat:enterprise_linux:8",
          "cpe:/a:redhat:enterprise_linux:8::appstream",
          "cpe:/a:redhat:enterprise_linux:8::crb",
          "cpe:/a:redhat:enterprise_linux:8::highavailability",
          "cpe:/a:redhat:enterprise_linux:8::nfv",
          "cpe:/a:redhat:enterprise_linux:8::realtime",
          "cpe:/a:redhat:enterprise_linux:8::resilientstorage",
          "cpe:/a:redhat:enterprise_linux:8::sap",
          "cpe:/a:redhat:enterprise_linux:8::sap_hana",
          "cpe:/a:redhat:enterprise_linux:8::supplementary",
          "cpe:/o:redhat:enterprise_linux:8",
          "cpe:/o:redhat:enterprise_linux:8::baseos"
        ]
      },
      "issued": {}
    },
    "affected": {}
  },
  "criteria": {
    "operator": "OR",
    "criterias": [
      {
        "operator": "AND",
        "criterions": [
          {
            "test_ref": "oval:com.redhat.cve:tst:20052541003",
            "comment": "Red Hat Enterprise Linux 8 is installed"
          },
          {
            "test_ref": "oval:com.redhat.cve:tst:20185389003",
            "comment": "libreswan is installed"
          },
          {
            "test_ref": "oval:com.redhat.cve:tst:20185389004",
            "comment": "libreswan is signed with Red Hat redhatrelease2 key"
          }
        ]
      }
    ],
    "criterions": [
      {
        "test_ref": "oval:com.redhat.cve:tst:20052541004",
        "comment": "Red Hat Enterprise Linux must be installed"
      }
    ]
  }
}
