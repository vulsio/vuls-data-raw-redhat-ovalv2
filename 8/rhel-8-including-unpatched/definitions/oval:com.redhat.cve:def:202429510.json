{
	"id": "oval:com.redhat.cve:def:202429510",
	"version": "636",
	"class": "vulnerability",
	"metadata": {
		"title": "ghostscript: format string injection leads to shell command execution (SAFER bypass) (moderate)",
		"reference": [
			{
				"ref_id": "CVE-2024-29510",
				"ref_url": "https://access.redhat.com/security/cve/CVE-2024-29510",
				"source": "CVE"
			}
		],
		"description": "DOCUMENTATION: A flaw was found in Ghostscript. The `uniprint` device allows the user to provide various string fragments as device options, which are later appended to the output file. Two parameters, `upWriteComponentCommands` and `upYMoveCommand,` are treated as format strings, specifically for `gp_fprintf` and `gs_snprintf.` This was designed for the user to include just one format specifier in the string, but there is no logic preventing arbitrary format strings with multiple specifiers from being used. In certain circumstances, an attacker may be able to exploit this to leak data from the stack and perform memory corruption. \n            \n            MITIGATION: Passing the -dSAFER safety argument on the command line prevents the issue by locking security-related variables after Ghostscript's initialization. In RHEL 9, -dSAFER is enabled by default, ensuring that insecure commands are rejected in a safer environment. In RHEL 7 and 8, the SAFER environment variable is not enabled by default meaning the vulnerability (focused on bypassing the SAFER environment) is not applicable.  If the SAFER environment variable is enabled, then the proposed mitigation is to explicitly pass -dSAFER on the command line, addressing the vulnerability that allows insecure commands within PostScript files. Since the OPVP device cannot be removed, we recommend to use -dSAFER in RHEL 7 and 8 as a practical security measure.",
		"advisory": {
			"from": "secalert@redhat.com",
			"severity": "Moderate",
			"updated": {
				"date": "2024-07-17"
			},
			"cve": [
				{
					"text": "CVE-2024-29510",
					"cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N",
					"cwe": "CWE-20",
					"href": "https://access.redhat.com/security/cve/CVE-2024-29510",
					"impact": "moderate",
					"public": "20240516"
				}
			],
			"affected": {
				"resolution": [
					{
						"state": "Will not fix",
						"component": [
							"gimp:flatpak/ghostscript",
							"gimp:flatpak/ghostscript-doc",
							"gimp:flatpak/ghostscript-tools-dvipdf",
							"gimp:flatpak/ghostscript-tools-fonts",
							"gimp:flatpak/ghostscript-tools-printing",
							"gimp:flatpak/ghostscript-x11",
							"gimp:flatpak/libgs",
							"gimp:flatpak/libgs-devel"
						]
					}
				]
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/a:redhat:enterprise_linux:8",
					"cpe:/a:redhat:enterprise_linux:8::appstream",
					"cpe:/a:redhat:enterprise_linux:8::crb",
					"cpe:/a:redhat:enterprise_linux:8::highavailability",
					"cpe:/a:redhat:enterprise_linux:8::nfv",
					"cpe:/a:redhat:enterprise_linux:8::realtime",
					"cpe:/a:redhat:enterprise_linux:8::resilientstorage",
					"cpe:/a:redhat:enterprise_linux:8::sap",
					"cpe:/a:redhat:enterprise_linux:8::sap_hana",
					"cpe:/a:redhat:enterprise_linux:8::supplementary",
					"cpe:/o:redhat:enterprise_linux:8",
					"cpe:/o:redhat:enterprise_linux:8::baseos"
				]
			},
			"issued": {}
		},
		"affected": {}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterias": [
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201819478007",
										"comment": "ghostscript-tools-dvipdf is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201819478008",
										"comment": "ghostscript-tools-dvipdf is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201819478015",
										"comment": "ghostscript-doc is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201819478016",
										"comment": "ghostscript-doc is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201819478009",
										"comment": "ghostscript-tools-fonts is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201819478010",
										"comment": "ghostscript-tools-fonts is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201819478017",
										"comment": "libgs is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201819478018",
										"comment": "libgs is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201819478011",
										"comment": "ghostscript-tools-printing is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201819478012",
										"comment": "ghostscript-tools-printing is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201819478003",
										"comment": "ghostscript-x11 is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201819478004",
										"comment": "ghostscript-x11 is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201819478013",
										"comment": "ghostscript is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201819478014",
										"comment": "ghostscript is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:201819478005",
										"comment": "libgs-devel is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:201819478006",
										"comment": "libgs-devel is signed with Red Hat redhatrelease2 key"
									}
								]
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:com.redhat.cve:tst:20052541003",
						"comment": "Red Hat Enterprise Linux 8 is installed"
					},
					{
						"test_ref": "oval:com.redhat.cve:tst:201925059017",
						"comment": "Module gimp:flatpak is enabled"
					}
				]
			}
		],
		"criterions": [
			{
				"test_ref": "oval:com.redhat.cve:tst:20052541004",
				"comment": "Red Hat Enterprise Linux must be installed"
			}
		]
	}
}
