{
	"id": "oval:com.redhat.cve:def:20243661",
	"version": "636",
	"class": "vulnerability",
	"metadata": {
		"title": "DHCP: DHCP routing options can manipulate interface-based VPN traffic (moderate)",
		"reference": [
			{
				"ref_id": "CVE-2024-3661",
				"ref_url": "https://access.redhat.com/security/cve/CVE-2024-3661",
				"source": "CVE"
			}
		],
		"description": "DOCUMENTATION: DHCP can add routes to a clientâ€™s routing table via the classless static route option (121). VPN-based security solutions that rely on routes to redirect traffic can be forced to leak traffic over the physical interface. An attacker on the same local network can read, disrupt, or possibly modify network traffic expected to be protected by the VPN. \n            STATEMENT: This issue affects only VPN network connections running along with DHCP enabled interface.\n\nIPSec VPN (ipsec-interface and vti-interface are set to no or undefined) is not vulnerable to this issue.\n            MITIGATION: This issue can be mitigated by placing the VPN routes in a dedicated routing table with a low priority.\n\n1. Assign the VPN routes to a dedicated routing table. By default, RHEL does not use the routing tables 1-252, and you can use one of them. If you configured the system to use some of these tables, identify a free routing table number.\n\n# nmcli connection modify <VPN_connection_profile> ipv4.route-table <routing_table_number>\n\nExample:\n# nmcli connection modify \"Company VPN\" ipv4.route-table 111\n\n2. Set a low priority for the table you used in the previous command. The priority value can be any value between 1 and 32766 but, the higher the value, the lower the priority!\n\n# nmcli connection modify <VPN_connection_profile> ipv4.routing-rules \"priority <low_priority_value> from all table <routing_table_number>\"\n\nExample:\n# nmcli connection modify \"Company VPN\" ipv4.routing-rules \"priority 32345 from all table 111\"\n\n3. Reconnect the VPN.\n\n# nmcli connection down <VPN_connection_profile>\n# nmcli connection up <VPN_connection_profile>",
		"advisory": {
			"from": "secalert@redhat.com",
			"severity": "Moderate",
			"updated": {
				"date": "2025-01-09"
			},
			"cve": [
				{
					"text": "CVE-2024-3661",
					"cvss3": "7.6/CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L",
					"cwe": "(CWE-306|CWE-501)",
					"href": "https://access.redhat.com/security/cve/CVE-2024-3661",
					"impact": "moderate",
					"public": "20240506:1831"
				}
			],
			"affected": {
				"resolution": [
					{
						"state": "Affected",
						"component": [
							"NetworkManager",
							"NetworkManager-adsl",
							"NetworkManager-bluetooth",
							"NetworkManager-cloud-setup",
							"NetworkManager-config-connectivity-redhat",
							"NetworkManager-config-server",
							"NetworkManager-dispatcher-routing-rules",
							"NetworkManager-libnm",
							"NetworkManager-libnm-devel",
							"NetworkManager-ovs",
							"NetworkManager-ppp",
							"NetworkManager-team",
							"NetworkManager-tui",
							"NetworkManager-wifi",
							"NetworkManager-wwan"
						]
					}
				]
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/a:redhat:enterprise_linux:8",
					"cpe:/a:redhat:enterprise_linux:8::appstream",
					"cpe:/a:redhat:enterprise_linux:8::crb",
					"cpe:/a:redhat:enterprise_linux:8::highavailability",
					"cpe:/a:redhat:enterprise_linux:8::nfv",
					"cpe:/a:redhat:enterprise_linux:8::realtime",
					"cpe:/a:redhat:enterprise_linux:8::resilientstorage",
					"cpe:/a:redhat:enterprise_linux:8::sap",
					"cpe:/a:redhat:enterprise_linux:8::sap_hana",
					"cpe:/a:redhat:enterprise_linux:8::supplementary",
					"cpe:/o:redhat:enterprise_linux:8",
					"cpe:/o:redhat:enterprise_linux:8::baseos"
				]
			},
			"issued": {}
		},
		"affected": {}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterias": [
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661001",
										"comment": "NetworkManager-dispatcher-routing-rules is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661002",
										"comment": "NetworkManager-dispatcher-routing-rules is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661003",
										"comment": "NetworkManager is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661004",
										"comment": "NetworkManager is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661005",
										"comment": "NetworkManager-ppp is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661006",
										"comment": "NetworkManager-ppp is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661007",
										"comment": "NetworkManager-wwan is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661008",
										"comment": "NetworkManager-wwan is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661009",
										"comment": "NetworkManager-bluetooth is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661010",
										"comment": "NetworkManager-bluetooth is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661011",
										"comment": "NetworkManager-config-server is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661012",
										"comment": "NetworkManager-config-server is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661013",
										"comment": "NetworkManager-team is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661014",
										"comment": "NetworkManager-team is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661015",
										"comment": "NetworkManager-libnm-devel is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661016",
										"comment": "NetworkManager-libnm-devel is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661017",
										"comment": "NetworkManager-wifi is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661018",
										"comment": "NetworkManager-wifi is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661019",
										"comment": "NetworkManager-cloud-setup is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661020",
										"comment": "NetworkManager-cloud-setup is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661021",
										"comment": "NetworkManager-adsl is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661022",
										"comment": "NetworkManager-adsl is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661023",
										"comment": "NetworkManager-config-connectivity-redhat is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661024",
										"comment": "NetworkManager-config-connectivity-redhat is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661025",
										"comment": "NetworkManager-tui is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661026",
										"comment": "NetworkManager-tui is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661027",
										"comment": "NetworkManager-ovs is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661028",
										"comment": "NetworkManager-ovs is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661029",
										"comment": "NetworkManager-libnm is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:20243661030",
										"comment": "NetworkManager-libnm is signed with Red Hat redhatrelease2 key"
									}
								]
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:com.redhat.cve:tst:20052541003",
						"comment": "Red Hat Enterprise Linux 8 is installed"
					}
				]
			}
		],
		"criterions": [
			{
				"test_ref": "oval:com.redhat.cve:tst:20052541004",
				"comment": "Red Hat Enterprise Linux must be installed"
			}
		]
	}
}
