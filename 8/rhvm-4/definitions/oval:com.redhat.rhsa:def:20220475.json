{
  "id": "oval:com.redhat.rhsa:def:20220475",
  "version": "638",
  "class": "patch",
  "metadata": {
    "title": "RHSA-2022:0475: RHV Manager (ovirt-engine) security update [ovirt-4.4.10-1] (Low)",
    "reference": [
      {
        "ref_id": "RHSA-2022:0475",
        "ref_url": "https://access.redhat.com/errata/RHSA-2022:0475",
        "source": "RHSA"
      },
      {
        "ref_id": "CVE-2021-4104",
        "ref_url": "https://access.redhat.com/security/cve/CVE-2021-4104",
        "source": "CVE"
      },
      {
        "ref_id": "CVE-2022-23302",
        "ref_url": "https://access.redhat.com/security/cve/CVE-2022-23302",
        "source": "CVE"
      },
      {
        "ref_id": "CVE-2022-23305",
        "ref_url": "https://access.redhat.com/security/cve/CVE-2022-23305",
        "source": "CVE"
      },
      {
        "ref_id": "CVE-2022-23307",
        "ref_url": "https://access.redhat.com/security/cve/CVE-2022-23307",
        "source": "CVE"
      }
    ],
    "description": "The ovirt-engine package provides the manager for virtualization environments.\nThis manager enables admins to define hosts and networks, as well as to add\nstorage, create VMs and manage user permissions.\n\nSecurity Fix(es):\n\n* log4j: SQL injection in Log4j 1.x when application is configured to use JDBCAppender (CVE-2022-23305)\n\n* log4j: Unsafe deserialization flaw in Chainsaw log viewer (CVE-2022-23307)\n\n* log4j: Remote code execution in Log4j 1.x when application is configured to use JMSAppender (CVE-2021-4104)\n\n* log4j: Remote code execution in Log4j 1.x when application is configured to use JMSSink (CVE-2022-23302)\n\nFor more details about the security issue(s), including the impact, a CVSS score, acknowledgments, and other related information, refer to the CVE page(s) listed in the References section.\n\nBug Fix(es):\n\nBug Fix(es):\n\n* With this release, the ovirt-engine-extension-logger-log4j package has been removed. It is replaced by an internal ovirt-engine implementation. \n\nWhen upgrading from earlier Red Hat Virtualization versions to RHV 4.4.10, the ovirt-engine-extension-logger-log4j package is uninstalled if it is present. If you used the ovirt-engine-extension-logger-log4j in earlier Red Hat Virtualization versions, you must manually remove the ovirt-engine-extension-logger-log4j configuration files and configure the new feature for sending log records to a remote syslog service, as outlined in the Administration Guide.\n\nAfter a successful upgrade to RHV 4.4.10, you can uninstall log4j12 without breaking the Red Hat Virtualization setup by running the following command: `$ dnf remove log4j12`. (BZ#2044277)\n\n* Previously, when preparing a host with FIPS kernel parameters enabled, the boot UUID parameter was blank after reboot. In this release, the UUID is present in the kernel arguments. Enabling FIPS does not change the UUID after reboot. (BZ#2013430)\n\n* Because installing the self-hosted engine with Cockpit is deprecated, the 'Installing Red Hat Virtualization as a self-hosted engine using the Cockpit web interface' link\non the Red Hat Virtualization Administration Portal login page has been replaced with the \"Installing Red Hat Virtualization as a self-hosted engine using the command line\" link. (BZ#1992476)\n\n* In this release, Red Hat Virtualization 4.4.10 requires snmp4j version 3.6.4 or later, which no longer depends on the log4j library. (BZ#2044257)",
    "advisory": {
      "from": "secalert@redhat.com",
      "severity": "Low",
      "updated": {
        "date": "2022-02-08"
      },
      "cve": [
        {
          "text": "CVE-2021-4104",
          "cvss3": "7.5/CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "cwe": "CWE-20",
          "href": "https://access.redhat.com/security/cve/CVE-2021-4104",
          "impact": "low",
          "public": "20211210"
        },
        {
          "text": "CVE-2022-23302",
          "cvss3": "8.8/CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "cwe": "CWE-502",
          "href": "https://access.redhat.com/security/cve/CVE-2022-23302",
          "impact": "low",
          "public": "20220118"
        },
        {
          "text": "CVE-2022-23305",
          "cvss3": "8.8/CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "cwe": "CWE-89",
          "href": "https://access.redhat.com/security/cve/CVE-2022-23305",
          "impact": "low",
          "public": "20220118"
        },
        {
          "text": "CVE-2022-23307",
          "cvss3": "8.8/CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "cwe": "CWE-502",
          "href": "https://access.redhat.com/security/cve/CVE-2022-23307",
          "impact": "low",
          "public": "20220118"
        }
      ],
      "affected": {},
      "affected_cpe_list": {
        "cpe": [
          "cpe:/a:redhat:rhev_manager:4.4",
          "cpe:/a:redhat:rhev_manager:4.4:el8"
        ]
      },
      "rights": "Copyright 2022 Red Hat, Inc.",
      "issued": {
        "date": "2022-02-08"
      },
      "bugzilla": [
        {
          "text": "Remote code execution in Log4j 1.x when application is configured to use JMSAppender",
          "href": "https://bugzilla.redhat.com/2031667",
          "id": "2031667"
        },
        {
          "text": "CVE-2022-23302 log4j: Remote code execution in Log4j 1.x when application is configured to use JMSSink",
          "href": "https://bugzilla.redhat.com/2041949",
          "id": "2041949"
        },
        {
          "text": "CVE-2022-23305 log4j: SQL injection in Log4j 1.x when application is configured to use JDBCAppender",
          "href": "https://bugzilla.redhat.com/2041959",
          "id": "2041959"
        },
        {
          "text": "CVE-2022-23307 log4j: Unsafe deserialization flaw in Chainsaw log viewer",
          "href": "https://bugzilla.redhat.com/2041967",
          "id": "2041967"
        }
      ]
    },
    "affected": {
      "family": "unix",
      "platform": [
        "Red Hat Virtualization Engine 4.4"
      ]
    }
  },
  "criteria": {
    "operator": "OR",
    "criterias": [
      {
        "operator": "AND",
        "criterias": [
          {
            "operator": "OR",
            "criterions": [
              {
                "test_ref": "oval:com.redhat.rhsa:tst:20203247049",
                "comment": "Red Hat Enterprise Linux 8 is installed"
              },
              {
                "test_ref": "oval:com.redhat.rhsa:tst:20203247050",
                "comment": "Red Hat CoreOS 4 is installed"
              }
            ]
          },
          {
            "operator": "OR",
            "criterias": [
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20220475001",
                    "comment": "snmp4j is earlier than 0:3.6.4-0.1.el8ev"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20220475002",
                    "comment": "snmp4j is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20220475003",
                    "comment": "snmp4j-javadoc is earlier than 0:3.6.4-0.1.el8ev"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20220475004",
                    "comment": "snmp4j-javadoc is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20220475005",
                    "comment": "ovirt-engine is earlier than 0:4.4.10.6-0.1.el8ev"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20203247010",
                    "comment": "ovirt-engine is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20220475007",
                    "comment": "ovirt-engine-backend is earlier than 0:4.4.10.6-0.1.el8ev"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20203247012",
                    "comment": "ovirt-engine-backend is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20220475009",
                    "comment": "ovirt-engine-dbscripts is earlier than 0:4.4.10.6-0.1.el8ev"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20203247014",
                    "comment": "ovirt-engine-dbscripts is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20220475011",
                    "comment": "ovirt-engine-health-check-bundler is earlier than 0:4.4.10.6-0.1.el8ev"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20203247016",
                    "comment": "ovirt-engine-health-check-bundler is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20220475013",
                    "comment": "ovirt-engine-restapi is earlier than 0:4.4.10.6-0.1.el8ev"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20203247018",
                    "comment": "ovirt-engine-restapi is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20220475015",
                    "comment": "ovirt-engine-setup is earlier than 0:4.4.10.6-0.1.el8ev"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20203247020",
                    "comment": "ovirt-engine-setup is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20220475017",
                    "comment": "ovirt-engine-setup-base is earlier than 0:4.4.10.6-0.1.el8ev"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20203247022",
                    "comment": "ovirt-engine-setup-base is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20220475019",
                    "comment": "ovirt-engine-setup-plugin-cinderlib is earlier than 0:4.4.10.6-0.1.el8ev"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20203247024",
                    "comment": "ovirt-engine-setup-plugin-cinderlib is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20220475021",
                    "comment": "ovirt-engine-setup-plugin-imageio is earlier than 0:4.4.10.6-0.1.el8ev"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20203247026",
                    "comment": "ovirt-engine-setup-plugin-imageio is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20220475023",
                    "comment": "ovirt-engine-setup-plugin-ovirt-engine is earlier than 0:4.4.10.6-0.1.el8ev"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20203247028",
                    "comment": "ovirt-engine-setup-plugin-ovirt-engine is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20220475025",
                    "comment": "ovirt-engine-setup-plugin-ovirt-engine-common is earlier than 0:4.4.10.6-0.1.el8ev"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20203247030",
                    "comment": "ovirt-engine-setup-plugin-ovirt-engine-common is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20220475027",
                    "comment": "ovirt-engine-setup-plugin-vmconsole-proxy-helper is earlier than 0:4.4.10.6-0.1.el8ev"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20203247032",
                    "comment": "ovirt-engine-setup-plugin-vmconsole-proxy-helper is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20220475029",
                    "comment": "ovirt-engine-setup-plugin-websocket-proxy is earlier than 0:4.4.10.6-0.1.el8ev"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20203247034",
                    "comment": "ovirt-engine-setup-plugin-websocket-proxy is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20220475031",
                    "comment": "ovirt-engine-tools is earlier than 0:4.4.10.6-0.1.el8ev"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20203247036",
                    "comment": "ovirt-engine-tools is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20220475033",
                    "comment": "ovirt-engine-tools-backup is earlier than 0:4.4.10.6-0.1.el8ev"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20203247038",
                    "comment": "ovirt-engine-tools-backup is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20220475035",
                    "comment": "ovirt-engine-vmconsole-proxy-helper is earlier than 0:4.4.10.6-0.1.el8ev"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20203247040",
                    "comment": "ovirt-engine-vmconsole-proxy-helper is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20220475037",
                    "comment": "ovirt-engine-webadmin-portal is earlier than 0:4.4.10.6-0.1.el8ev"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20203247042",
                    "comment": "ovirt-engine-webadmin-portal is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20220475039",
                    "comment": "ovirt-engine-websocket-proxy is earlier than 0:4.4.10.6-0.1.el8ev"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20203247044",
                    "comment": "ovirt-engine-websocket-proxy is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20220475041",
                    "comment": "python3-ovirt-engine-lib is earlier than 0:4.4.10.6-0.1.el8ev"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20203247046",
                    "comment": "python3-ovirt-engine-lib is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20220475043",
                    "comment": "rhvm is earlier than 0:4.4.10.6-0.1.el8ev"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20203247048",
                    "comment": "rhvm is signed with Red Hat redhatrelease2 key"
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "criterions": [
      {
        "test_ref": "oval:com.redhat.rhsa:tst:20203247051",
        "comment": "Red Hat Enterprise Linux must be installed"
      }
    ]
  }
}
