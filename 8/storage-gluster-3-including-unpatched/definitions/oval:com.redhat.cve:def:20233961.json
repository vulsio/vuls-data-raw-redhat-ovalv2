{
	"id": "oval:com.redhat.cve:def:20233961",
	"version": "636",
	"class": "vulnerability",
	"metadata": {
		"title": "samba: smbd allows client access to unix domain sockets on the file system as root (moderate)",
		"reference": [
			{
				"ref_id": "CVE-2023-3961",
				"ref_url": "https://access.redhat.com/security/cve/CVE-2023-3961",
				"source": "CVE"
			}
		],
		"description": "DOCUMENTATION: A path traversal vulnerability was identified in Samba when processing client pipe names connecting to Unix domain sockets within a private directory. Samba typically uses this mechanism to connect SMB clients to remote procedure call (RPC) services like SAMR LSA or SPOOLSS, which Samba initiates on demand. However, due to inadequate sanitization of incoming client pipe names, allowing a client to send a pipe name containing Unix directory traversal characters (../). This could result in SMB clients connecting as root to Unix domain sockets outside the private directory. If an attacker or client managed to send a pipe name resolving to an external service using an existing Unix domain socket, it could potentially lead to unauthorized access to the service and consequential adverse events, including compromise or service crashes. \n            \n            MITIGATION: Mitigation for this issue is either not available or the currently available options don't meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
		"advisory": {
			"from": "secalert@redhat.com",
			"severity": "Moderate",
			"updated": {
				"date": "2023-11-14"
			},
			"cve": [
				{
					"text": "CVE-2023-3961",
					"cvss3": "6.5/CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:L",
					"cwe": "CWE-22",
					"href": "https://access.redhat.com/security/cve/CVE-2023-3961",
					"impact": "moderate",
					"public": "20231010"
				}
			],
			"affected": {
				"resolution": [
					{
						"state": "Affected",
						"component": [
							"ctdb",
							"libsmbclient",
							"libsmbclient-devel",
							"libwbclient",
							"libwbclient-devel",
							"python3-samba",
							"samba",
							"samba-client",
							"samba-client-libs",
							"samba-common",
							"samba-common-libs",
							"samba-common-tools",
							"samba-devel",
							"samba-krb5-printing",
							"samba-libs",
							"samba-pidl",
							"samba-vfs-glusterfs",
							"samba-winbind",
							"samba-winbind-clients",
							"samba-winbind-krb5-locator",
							"samba-winbind-modules"
						]
					}
				]
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/a:redhat:storage:3.5",
					"cpe:/a:redhat:storage:3.5:nfs:el8",
					"cpe:/a:redhat:storage:3.5:samba:el8",
					"cpe:/a:redhat:storage:3.5:server:el8"
				]
			},
			"issued": {}
		},
		"affected": {}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterias": [
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251025",
										"comment": "samba-common is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251026",
										"comment": "samba-common is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251001",
										"comment": "samba-libs is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251002",
										"comment": "samba-libs is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251009",
										"comment": "samba-pidl is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251010",
										"comment": "samba-pidl is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251039",
										"comment": "libsmbclient is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251040",
										"comment": "libsmbclient is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251017",
										"comment": "samba-client is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251018",
										"comment": "samba-client is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251027",
										"comment": "ctdb is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251028",
										"comment": "ctdb is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251021",
										"comment": "samba-krb5-printing is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251022",
										"comment": "samba-krb5-printing is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251011",
										"comment": "samba-winbind-krb5-locator is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251012",
										"comment": "samba-winbind-krb5-locator is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251007",
										"comment": "libsmbclient-devel is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251008",
										"comment": "libsmbclient-devel is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251019",
										"comment": "samba-common-tools is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251020",
										"comment": "samba-common-tools is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251005",
										"comment": "samba-devel is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251006",
										"comment": "samba-devel is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251033",
										"comment": "samba-client-libs is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251034",
										"comment": "samba-client-libs is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251023",
										"comment": "samba-common-libs is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251024",
										"comment": "samba-common-libs is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251013",
										"comment": "samba-vfs-glusterfs is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251014",
										"comment": "samba-vfs-glusterfs is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251003",
										"comment": "samba-winbind-modules is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251004",
										"comment": "samba-winbind-modules is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251029",
										"comment": "libwbclient-devel is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251030",
										"comment": "libwbclient-devel is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251035",
										"comment": "python3-samba is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251036",
										"comment": "python3-samba is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251031",
										"comment": "samba-winbind-clients is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251032",
										"comment": "samba-winbind-clients is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251043",
										"comment": "samba-winbind is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251044",
										"comment": "samba-winbind is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251041",
										"comment": "samba is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251042",
										"comment": "samba is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251015",
										"comment": "libwbclient is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202120251016",
										"comment": "libwbclient is signed with Red Hat redhatrelease2 key"
									}
								]
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:com.redhat.cve:tst:201718638003",
						"comment": "Red Hat Enterprise Linux 8 is installed"
					}
				]
			}
		],
		"criterions": [
			{
				"test_ref": "oval:com.redhat.cve:tst:201718638004",
				"comment": "Red Hat Enterprise Linux must be installed"
			}
		]
	}
}
