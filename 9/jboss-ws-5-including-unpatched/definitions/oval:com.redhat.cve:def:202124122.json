{
  "id": "oval:com.redhat.cve:def:202124122",
  "version": "636",
  "class": "vulnerability",
  "metadata": {
    "title": "CVE-2021-24122 tomcat: Information disclosure when using NTFS file system (moderate)",
    "reference": [
      {
        "ref_id": "CVE-2021-24122",
        "ref_url": "https://access.redhat.com/security/cve/CVE-2021-24122",
        "source": "CVE"
      }
    ],
    "description": "DOCUMENTATION: A flaw was found in Apache Tomcat. When serving resources from a network location using the NTFS file system, it was possible to bypass security constraints and view the source code for JSPs in some configurations. The root cause was the unexpected behavior of the JRE API File.getCanonicalPath(), which was caused by the inconsistent behavior of the Windows API (FindFirstFileW) in some circumstances. The highest threat from this vulnerability is to confidentiality. \n            STATEMENT: In Red Hat OpenStack Platform's OpenDaylight, tomcat is disabled by default.  Further, ODL deployments are not supported on untrusted administrator networks; even if tomcat is enabled, if random users can access it, this would be in an unsupported configuration. For this reason, the RHOSP impact has been reduced and no update will be provided at this time for the ODL tomcat package.\n\nThis flaw does not affect tomcat or pki-servlet-engine as shipped with Red Hat Enterprise Linux 6, 7, or 8 because the functionality involving FindFirstFileW() is specific to the Windows native code. Additionally, RHEL is not shipped with NTFS support.",
    "advisory": {
      "from": "secalert@redhat.com",
      "severity": "Moderate",
      "updated": {
        "date": "2022-07-07"
      },
      "cve": [
        {
          "text": "CVE-2021-24122",
          "cvss3": "5.9/CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "cwe": "CWE-200",
          "href": "https://access.redhat.com/security/cve/CVE-2021-24122",
          "impact": "moderate",
          "public": "20210114"
        }
      ],
      "affected": {
        "resolution": [
          {
            "state": "Affected",
            "component": [
              "jws5-tomcat"
            ]
          }
        ]
      },
      "affected_cpe_list": {
        "cpe": [
          "cpe:/a:redhat:jboss_enterprise_web_server:5.6",
          "cpe:/a:redhat:jboss_enterprise_web_server:5.6::el9",
          "cpe:/a:redhat:jboss_enterprise_web_server:5.7",
          "cpe:/a:redhat:jboss_enterprise_web_server:5.7::el9"
        ]
      },
      "issued": {}
    },
    "affected": {}
  },
  "criteria": {
    "operator": "OR",
    "criterias": [
      {
        "operator": "AND",
        "criterions": [
          {
            "test_ref": "oval:com.redhat.cve:tst:20188014003",
            "comment": "Red Hat Enterprise Linux 9 is installed"
          },
          {
            "test_ref": "oval:com.redhat.cve:tst:20188014001",
            "comment": "jws5-tomcat is installed"
          },
          {
            "test_ref": "oval:com.redhat.cve:tst:20188014002",
            "comment": "jws5-tomcat is signed with Red Hat redhatrelease2 key"
          }
        ]
      }
    ],
    "criterions": [
      {
        "test_ref": "oval:com.redhat.cve:tst:20188014004",
        "comment": "Red Hat Enterprise Linux must be installed"
      }
    ]
  }
}
