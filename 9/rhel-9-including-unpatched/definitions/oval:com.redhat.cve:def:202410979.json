{
	"id": "oval:com.redhat.cve:def:202410979",
	"version": "636",
	"class": "vulnerability",
	"metadata": {
		"title": "postgresql: PostgreSQL PL/Perl environment variable changes execute arbitrary code (important)",
		"reference": [
			{
				"ref_id": "CVE-2024-10979",
				"ref_url": "https://access.redhat.com/security/cve/CVE-2024-10979",
				"source": "CVE"
			}
		],
		"description": "DOCUMENTATION: A flaw was found in PostgreSQL PL/Perl. This vulnerability allows an unprivileged database user to change sensitive process environment variables (e.g., PATH) via incorrect control of environment variables. \n            STATEMENT: This vulnerability has been given a severity rating of important because the ability to modify sensitive process environment variables (ex. PATH) can lead to unauthorized code execution and privilege escalation. Depending on the privileges of the PostgreSQL user, an attacker may be able to gain higher-level access to the underlying server and create functions who modify environment variables and execute arbitrary commands.\n            MITIGATION: Currently the following options exist to help mitigate the impact of this vulnerability: \n1) Restrict Permissions: the creation of PL/Python and PL/Perl functions should be limited to trusted users only. \n2) Environment Variable Sanitization: ensure that environment variables are properly sanitized and any modifications are restricted.\n3) Upgrade PostgreSQL: if a fix is released by the PostgreSQL Global Development Group, update to the latest version.\n4) Audit Database Functions: perform regular audits on user-created functions to detect and prevent potential exploitation.",
		"advisory": {
			"from": "secalert@redhat.com",
			"severity": "Important",
			"updated": {
				"date": "2024-11-26"
			},
			"cve": [
				{
					"text": "CVE-2024-10979",
					"cvss3": "8.8/CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
					"cwe": "CWE-15",
					"href": "https://access.redhat.com/security/cve/CVE-2024-10979",
					"impact": "important",
					"public": "20241114:1300"
				}
			],
			"affected": {
				"resolution": [
					{
						"state": "Affected",
						"component": [
							"postgresql",
							"postgresql-contrib",
							"postgresql-docs",
							"postgresql-plperl",
							"postgresql-plpython3",
							"postgresql-pltcl",
							"postgresql-private-devel",
							"postgresql-private-libs",
							"postgresql-server",
							"postgresql-server-devel",
							"postgresql-static",
							"postgresql-test",
							"postgresql-upgrade",
							"postgresql-upgrade-devel",
							"postgresql:15/postgresql",
							"postgresql:15/postgresql-contrib",
							"postgresql:15/postgresql-docs",
							"postgresql:15/postgresql-plperl",
							"postgresql:15/postgresql-plpython3",
							"postgresql:15/postgresql-pltcl",
							"postgresql:15/postgresql-private-devel",
							"postgresql:15/postgresql-private-libs",
							"postgresql:15/postgresql-server",
							"postgresql:15/postgresql-server-devel",
							"postgresql:15/postgresql-static",
							"postgresql:15/postgresql-test",
							"postgresql:15/postgresql-upgrade",
							"postgresql:15/postgresql-upgrade-devel",
							"postgresql:16/postgresql",
							"postgresql:16/postgresql-contrib",
							"postgresql:16/postgresql-docs",
							"postgresql:16/postgresql-plperl",
							"postgresql:16/postgresql-plpython3",
							"postgresql:16/postgresql-pltcl",
							"postgresql:16/postgresql-private-devel",
							"postgresql:16/postgresql-private-libs",
							"postgresql:16/postgresql-server",
							"postgresql:16/postgresql-server-devel",
							"postgresql:16/postgresql-static",
							"postgresql:16/postgresql-test",
							"postgresql:16/postgresql-upgrade",
							"postgresql:16/postgresql-upgrade-devel"
						]
					}
				]
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/a:redhat:enterprise_linux:9",
					"cpe:/a:redhat:enterprise_linux:9::appstream",
					"cpe:/a:redhat:enterprise_linux:9::crb",
					"cpe:/a:redhat:enterprise_linux:9::highavailability",
					"cpe:/a:redhat:enterprise_linux:9::nfv",
					"cpe:/a:redhat:enterprise_linux:9::realtime",
					"cpe:/a:redhat:enterprise_linux:9::resilientstorage",
					"cpe:/a:redhat:enterprise_linux:9::sap",
					"cpe:/a:redhat:enterprise_linux:9::sap_hana",
					"cpe:/a:redhat:enterprise_linux:9::supplementary",
					"cpe:/o:redhat:enterprise_linux:9",
					"cpe:/o:redhat:enterprise_linux:9::baseos"
				]
			},
			"issued": {}
		},
		"affected": {}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterias": [
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976015",
										"comment": "postgresql-test is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976016",
										"comment": "postgresql-test is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976009",
										"comment": "postgresql-private-libs is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976010",
										"comment": "postgresql-private-libs is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976005",
										"comment": "postgresql is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976006",
										"comment": "postgresql is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976017",
										"comment": "postgresql-contrib is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976018",
										"comment": "postgresql-contrib is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976013",
										"comment": "postgresql-upgrade-devel is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976014",
										"comment": "postgresql-upgrade-devel is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976019",
										"comment": "postgresql-upgrade is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976020",
										"comment": "postgresql-upgrade is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976007",
										"comment": "postgresql-plperl is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976008",
										"comment": "postgresql-plperl is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976025",
										"comment": "postgresql-server is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976026",
										"comment": "postgresql-server is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976027",
										"comment": "postgresql-docs is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976028",
										"comment": "postgresql-docs is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976001",
										"comment": "postgresql-server-devel is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976002",
										"comment": "postgresql-server-devel is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976003",
										"comment": "postgresql-pltcl is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976004",
										"comment": "postgresql-pltcl is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976021",
										"comment": "postgresql-plpython3 is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976022",
										"comment": "postgresql-plpython3 is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976023",
										"comment": "postgresql-static is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976024",
										"comment": "postgresql-static is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976011",
										"comment": "postgresql-private-devel is installed"
									},
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976012",
										"comment": "postgresql-private-devel is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterias": [
									{
										"operator": "OR",
										"criterias": [
											{
												"operator": "AND",
												"criterions": [
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976021",
														"comment": "postgresql-plpython3 is installed"
													},
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976022",
														"comment": "postgresql-plpython3 is signed with Red Hat redhatrelease2 key"
													}
												]
											},
											{
												"operator": "AND",
												"criterions": [
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976023",
														"comment": "postgresql-static is installed"
													},
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976024",
														"comment": "postgresql-static is signed with Red Hat redhatrelease2 key"
													}
												]
											},
											{
												"operator": "AND",
												"criterions": [
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976009",
														"comment": "postgresql-private-libs is installed"
													},
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976010",
														"comment": "postgresql-private-libs is signed with Red Hat redhatrelease2 key"
													}
												]
											},
											{
												"operator": "AND",
												"criterions": [
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976017",
														"comment": "postgresql-contrib is installed"
													},
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976018",
														"comment": "postgresql-contrib is signed with Red Hat redhatrelease2 key"
													}
												]
											},
											{
												"operator": "AND",
												"criterions": [
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976015",
														"comment": "postgresql-test is installed"
													},
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976016",
														"comment": "postgresql-test is signed with Red Hat redhatrelease2 key"
													}
												]
											},
											{
												"operator": "AND",
												"criterions": [
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976013",
														"comment": "postgresql-upgrade-devel is installed"
													},
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976014",
														"comment": "postgresql-upgrade-devel is signed with Red Hat redhatrelease2 key"
													}
												]
											},
											{
												"operator": "AND",
												"criterions": [
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976019",
														"comment": "postgresql-upgrade is installed"
													},
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976020",
														"comment": "postgresql-upgrade is signed with Red Hat redhatrelease2 key"
													}
												]
											},
											{
												"operator": "AND",
												"criterions": [
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976027",
														"comment": "postgresql-docs is installed"
													},
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976028",
														"comment": "postgresql-docs is signed with Red Hat redhatrelease2 key"
													}
												]
											},
											{
												"operator": "AND",
												"criterions": [
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976003",
														"comment": "postgresql-pltcl is installed"
													},
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976004",
														"comment": "postgresql-pltcl is signed with Red Hat redhatrelease2 key"
													}
												]
											},
											{
												"operator": "AND",
												"criterions": [
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976011",
														"comment": "postgresql-private-devel is installed"
													},
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976012",
														"comment": "postgresql-private-devel is signed with Red Hat redhatrelease2 key"
													}
												]
											},
											{
												"operator": "AND",
												"criterions": [
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976005",
														"comment": "postgresql is installed"
													},
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976006",
														"comment": "postgresql is signed with Red Hat redhatrelease2 key"
													}
												]
											},
											{
												"operator": "AND",
												"criterions": [
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976007",
														"comment": "postgresql-plperl is installed"
													},
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976008",
														"comment": "postgresql-plperl is signed with Red Hat redhatrelease2 key"
													}
												]
											},
											{
												"operator": "AND",
												"criterions": [
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976025",
														"comment": "postgresql-server is installed"
													},
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976026",
														"comment": "postgresql-server is signed with Red Hat redhatrelease2 key"
													}
												]
											},
											{
												"operator": "AND",
												"criterions": [
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976001",
														"comment": "postgresql-server-devel is installed"
													},
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976002",
														"comment": "postgresql-server-devel is signed with Red Hat redhatrelease2 key"
													}
												]
											}
										]
									}
								],
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976030",
										"comment": "Module postgresql:16 is enabled"
									}
								]
							},
							{
								"operator": "AND",
								"criterias": [
									{
										"operator": "OR",
										"criterias": [
											{
												"operator": "AND",
												"criterions": [
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976021",
														"comment": "postgresql-plpython3 is installed"
													},
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976022",
														"comment": "postgresql-plpython3 is signed with Red Hat redhatrelease2 key"
													}
												]
											},
											{
												"operator": "AND",
												"criterions": [
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976023",
														"comment": "postgresql-static is installed"
													},
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976024",
														"comment": "postgresql-static is signed with Red Hat redhatrelease2 key"
													}
												]
											},
											{
												"operator": "AND",
												"criterions": [
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976009",
														"comment": "postgresql-private-libs is installed"
													},
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976010",
														"comment": "postgresql-private-libs is signed with Red Hat redhatrelease2 key"
													}
												]
											},
											{
												"operator": "AND",
												"criterions": [
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976017",
														"comment": "postgresql-contrib is installed"
													},
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976018",
														"comment": "postgresql-contrib is signed with Red Hat redhatrelease2 key"
													}
												]
											},
											{
												"operator": "AND",
												"criterions": [
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976015",
														"comment": "postgresql-test is installed"
													},
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976016",
														"comment": "postgresql-test is signed with Red Hat redhatrelease2 key"
													}
												]
											},
											{
												"operator": "AND",
												"criterions": [
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976013",
														"comment": "postgresql-upgrade-devel is installed"
													},
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976014",
														"comment": "postgresql-upgrade-devel is signed with Red Hat redhatrelease2 key"
													}
												]
											},
											{
												"operator": "AND",
												"criterions": [
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976019",
														"comment": "postgresql-upgrade is installed"
													},
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976020",
														"comment": "postgresql-upgrade is signed with Red Hat redhatrelease2 key"
													}
												]
											},
											{
												"operator": "AND",
												"criterions": [
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976027",
														"comment": "postgresql-docs is installed"
													},
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976028",
														"comment": "postgresql-docs is signed with Red Hat redhatrelease2 key"
													}
												]
											},
											{
												"operator": "AND",
												"criterions": [
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976003",
														"comment": "postgresql-pltcl is installed"
													},
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976004",
														"comment": "postgresql-pltcl is signed with Red Hat redhatrelease2 key"
													}
												]
											},
											{
												"operator": "AND",
												"criterions": [
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976011",
														"comment": "postgresql-private-devel is installed"
													},
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976012",
														"comment": "postgresql-private-devel is signed with Red Hat redhatrelease2 key"
													}
												]
											},
											{
												"operator": "AND",
												"criterions": [
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976005",
														"comment": "postgresql is installed"
													},
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976006",
														"comment": "postgresql is signed with Red Hat redhatrelease2 key"
													}
												]
											},
											{
												"operator": "AND",
												"criterions": [
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976007",
														"comment": "postgresql-plperl is installed"
													},
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976008",
														"comment": "postgresql-plperl is signed with Red Hat redhatrelease2 key"
													}
												]
											},
											{
												"operator": "AND",
												"criterions": [
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976025",
														"comment": "postgresql-server is installed"
													},
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976026",
														"comment": "postgresql-server is signed with Red Hat redhatrelease2 key"
													}
												]
											},
											{
												"operator": "AND",
												"criterions": [
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976001",
														"comment": "postgresql-server-devel is installed"
													},
													{
														"test_ref": "oval:com.redhat.cve:tst:202410976002",
														"comment": "postgresql-server-devel is signed with Red Hat redhatrelease2 key"
													}
												]
											}
										]
									}
								],
								"criterions": [
									{
										"test_ref": "oval:com.redhat.cve:tst:202410976029",
										"comment": "Module postgresql:15 is enabled"
									}
								]
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:com.redhat.cve:tst:20052541003",
						"comment": "Red Hat Enterprise Linux 9 is installed"
					}
				]
			}
		],
		"criterions": [
			{
				"test_ref": "oval:com.redhat.cve:tst:20052541004",
				"comment": "Red Hat Enterprise Linux must be installed"
			}
		]
	}
}
