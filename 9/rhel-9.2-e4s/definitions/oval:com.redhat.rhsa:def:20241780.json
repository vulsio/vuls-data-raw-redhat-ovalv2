{
	"id": "oval:com.redhat.rhsa:def:20241780",
	"version": "637",
	"class": "patch",
	"metadata": {
		"title": "RHSA-2024:1780: unbound security and bug fix update (Important)",
		"reference": [
			{
				"ref_id": "RHSA-2024:1780",
				"ref_url": "https://access.redhat.com/errata/RHSA-2024:1780",
				"source": "RHSA"
			},
			{
				"ref_id": "CVE-2024-1488",
				"ref_url": "https://access.redhat.com/security/cve/CVE-2024-1488",
				"source": "CVE"
			}
		],
		"description": "The unbound packages provide a validating, recursive, and caching DNS or DNSSEC\nresolver.\n\nSecurity Fix(es):\n\n* A vulnerability was found in Unbound due to incorrect default permissions,\nallowing any process outside the unbound group to modify the unbound runtime\nconfiguration. The default combination of the \"control-use-cert: no\" option with\neither explicit or implicit use of an IP address in the \"control-interface\"\noption could allow improper access. If a process can connect over localhost to\nport 8953, it can alter the configuration of unbound.service. This flaw allows\nan unprivileged local process to manipulate a running instance, potentially\naltering forwarders, allowing them to track all queries forwarded by the local\nresolver, and, in some cases, disrupting resolving altogether.\n\nTo mitigate the vulnerability, a new file\n\"/etc/unbound/conf.d/remote-control.conf\" has been added and included in the\nmain unbound configuration file, \"unbound.conf\". The file contains two\ndirectives that should limit access to unbound.conf:\n\n    control-interface: \"/run/unbound/control\"\n    control-use-cert: \"yes\"\n\nFor details about these directives, run \"man unbound.conf\".\n\nUpdating to the version of unbound provided by this advisory should, in most\ncases, address the vulnerability. To verify that your configuration is not\nvulnerable, use the \"unbound-control status | grep control\" command. If the\noutput contains \"control(ssl)\" or \"control(namedpipe)\", your configuration is\nnot vulnerable. If the command output returns only \"control\", the configuration\nis vulnerable because it does not enforce access only to the unbound group\nmembers. To fix your configuration, add the line \"include:\n/etc/unbound/conf.d/remote-control.conf\" to the end of the file\n\"/etc/unbound/unbound.conf\". If you use a custom\n\"/etc/unbound/conf.d/remote-control.conf\" file, add the new directives to this\nfile. (CVE-2024-1488)\n\nFor more details about the security issue(s), including the impact, a CVSS\nscore, acknowledgments, and other related information, refer to the CVE page(s)\nlisted in the References section.",
		"advisory": {
			"from": "secalert@redhat.com",
			"severity": "Important",
			"updated": {
				"date": "2024-04-11"
			},
			"cve": [
				{
					"text": "CVE-2024-1488",
					"cvss3": "8.0/CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:H/A:H",
					"cwe": "CWE-276->CWE-15",
					"href": "https://access.redhat.com/security/cve/CVE-2024-1488",
					"impact": "important",
					"public": "20240213"
				}
			],
			"affected": {},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/a:redhat:rhel_e4s:9.2",
					"cpe:/a:redhat:rhel_e4s:9.2::appstream",
					"cpe:/a:redhat:rhel_e4s:9.2::highavailability",
					"cpe:/a:redhat:rhel_e4s:9.2::nfv",
					"cpe:/a:redhat:rhel_e4s:9.2::realtime",
					"cpe:/a:redhat:rhel_e4s:9.2::resilientstorage",
					"cpe:/a:redhat:rhel_e4s:9.2::sap",
					"cpe:/a:redhat:rhel_e4s:9.2::sap_hana",
					"cpe:/o:redhat:rhel_e4s:9.2",
					"cpe:/o:redhat:rhel_e4s:9.2::baseos"
				]
			},
			"rights": "Copyright 2024 Red Hat, Inc.",
			"issued": {
				"date": "2024-04-11"
			},
			"bugzilla": [
				{
					"text": "unbound: unrestricted reconfiguration enabled to anyone that may lead to local privilege escalation",
					"href": "https://bugzilla.redhat.com/2264183",
					"id": "2264183"
				}
			]
		},
		"affected": {
			"family": "unix",
			"platform": [
				"Red Hat Enterprise Linux 9.2 Extended Update Support"
			]
		}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterias": [
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20241780001",
										"comment": "python3-unbound is earlier than 0:1.16.2-3.el9_2.4"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20228062002",
										"comment": "python3-unbound is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20241780003",
										"comment": "unbound is earlier than 0:1.16.2-3.el9_2.4"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20228062004",
										"comment": "unbound is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20241780005",
										"comment": "unbound-devel is earlier than 0:1.16.2-3.el9_2.4"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20228062006",
										"comment": "unbound-devel is signed with Red Hat redhatrelease2 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20241780007",
										"comment": "unbound-libs is earlier than 0:1.16.2-3.el9_2.4"
									},
									{
										"test_ref": "oval:com.redhat.rhsa:tst:20228062008",
										"comment": "unbound-libs is signed with Red Hat redhatrelease2 key"
									}
								]
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:com.redhat.rhba:tst:20223893007",
						"comment": "Red Hat Enterprise Linux 9 is installed"
					}
				]
			}
		],
		"criterions": [
			{
				"test_ref": "oval:com.redhat.rhba:tst:20223893008",
				"comment": "Red Hat Enterprise Linux must be installed"
			}
		]
	}
}
